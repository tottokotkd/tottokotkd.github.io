{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/clean-blog/source/css/mixins.styl","path":"css/mixins.styl","modified":0,"renderable":1},{"_id":"themes/clean-blog/source/css/article.styl","path":"css/article.styl","modified":0,"renderable":1},{"_id":"themes/clean-blog/source/css/base.styl","path":"css/base.styl","modified":0,"renderable":1},{"_id":"themes/clean-blog/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/clean-blog/source/css/variables.styl","path":"css/variables.styl","modified":0,"renderable":1},{"_id":"themes/clean-blog/source/img/about-bg.jpg","path":"img/about-bg.jpg","modified":0,"renderable":1},{"_id":"themes/clean-blog/source/img/home-bg.jpg","path":"img/home-bg.jpg","modified":0,"renderable":1},{"_id":"themes/clean-blog/source/img/contact-bg.jpg","path":"img/contact-bg.jpg","modified":0,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"6e4371b007c6dac4bb4dd83066d90ec6d8dc5d9d","modified":1487677555000},{"_id":"themes/clean-blog/LICENSE","hash":"8726b416df4f067cff579e859f05c4b594b8be09","modified":1487677253000},{"_id":"themes/clean-blog/README.md","hash":"c5c7b0fd01aa229304e7b00697517aaca51de577","modified":1487677253000},{"_id":"themes/clean-blog/_config.yml","hash":"12c1c83981feee45f0d2ff9ff4fe48b0332064cd","modified":1487677253000},{"_id":"source/_drafts/20161203.md","hash":"515bf7780b4ef1e69fcc334b6b4cdf1d2c40ad58","modified":1487678163000},{"_id":"source/_drafts/20170215.md","hash":"5a94248d75e95de5c5ad7c4dfff530c9298517b2","modified":1487678163000},{"_id":"source/_drafts/20170221.md","hash":"5dc63ce063eaf3f049f8774e020804ba003ec619","modified":1487678163000},{"_id":"source/_posts/20161120.md","hash":"6b8b46d4c450d8bd4931fa5c295af357468d39b1","modified":1487677182000},{"_id":"source/_posts/20161202.md","hash":"e0d1b57c3760a939d6a4b841aef0bc161d8f3074","modified":1487678163000},{"_id":"source/_posts/20161122.md","hash":"459dd83fef24d9cff533dc3a4b6057e2d2d15e8c","modified":1487678163000},{"_id":"source/_posts/20161211.md","hash":"59f950f118970bf2c20acf0fc689df8098c85af5","modified":1487678163000},{"_id":"source/_posts/20170221.md","hash":"a919ec93ec61ed780641beba92e7768aae8bdf66","modified":1487728994000},{"_id":"themes/clean-blog/.git/HEAD","hash":"308eafa1f684ac2b524818018028f25ad0c29cb2","modified":1487677529000},{"_id":"themes/clean-blog/.git/config","hash":"ec6d3c969503d51baa8446f299aa01a0b1c8da5a","modified":1487677253000},{"_id":"themes/clean-blog/.git/index","hash":"b7dd49924bb143521cd63cd6adcae01149bf6299","modified":1487678163000},{"_id":"themes/clean-blog/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1487677248000},{"_id":"themes/clean-blog/.git/packed-refs","hash":"13f06f9b49f050592e3ff9057f105496288b5fa2","modified":1487677253000},{"_id":"themes/clean-blog/languages/de.yml","hash":"424a9c1e6ab69334d7873f6574da02ca960aa572","modified":1487677253000},{"_id":"themes/clean-blog/languages/default.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1487677253000},{"_id":"themes/clean-blog/languages/en.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1487677253000},{"_id":"themes/clean-blog/languages/es.yml","hash":"cb4eeca0ed3768a77e0cd216300f2b2549628b1b","modified":1487677253000},{"_id":"themes/clean-blog/languages/fr.yml","hash":"e9e6f7cb362ebb7997f11027498a2748fe3bac95","modified":1487677253000},{"_id":"themes/clean-blog/languages/no.yml","hash":"8ca475a3b4f8efe6603030f0013aae39668230e1","modified":1487677253000},{"_id":"themes/clean-blog/languages/pl.yml","hash":"de7eb5850ae65ba7638e907c805fea90617a988c","modified":1487677253000},{"_id":"themes/clean-blog/languages/pt.yml","hash":"1d0c3689eb32fe13f37f8f6f303af7624ebfbaf0","modified":1487677253000},{"_id":"themes/clean-blog/languages/ru.yml","hash":"42df7afeb7a35dc46d272b7f4fb880a9d9ebcaa5","modified":1487677253000},{"_id":"themes/clean-blog/languages/zh-CN.yml","hash":"7bfcb0b8e97d7e5edcfca8ab26d55d9da2573c1c","modified":1487677253000},{"_id":"themes/clean-blog/languages/zh-TW.yml","hash":"9acac6cc4f8002c3fa53ff69fb8cf66c915bd016","modified":1487677253000},{"_id":"themes/clean-blog/layout/archive.ejs","hash":"ad0da72df13ce3566985bb390c2c9a9352cf4f07","modified":1487677253000},{"_id":"themes/clean-blog/layout/index.ejs","hash":"87995288ca6f95a04add641727aedd3f6afa55eb","modified":1487677253000},{"_id":"themes/clean-blog/layout/page.ejs","hash":"38382e9bbeb6b8d2eafbd53fff2984111f524c1a","modified":1487677253000},{"_id":"themes/clean-blog/layout/layout.ejs","hash":"da2f9018047924ddaf376aee5996c7ddc06cebc1","modified":1487677253000},{"_id":"themes/clean-blog/layout/post.ejs","hash":"38382e9bbeb6b8d2eafbd53fff2984111f524c1a","modified":1487677253000},{"_id":"source/_posts/20170221/1-1.png","hash":"9c302b892b5033f3fbb50d7a6f3034bc11a2c7f2","modified":1487684912000},{"_id":"themes/clean-blog/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1487677248000},{"_id":"themes/clean-blog/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1487677248000},{"_id":"themes/clean-blog/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1487677248000},{"_id":"themes/clean-blog/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1487677248000},{"_id":"themes/clean-blog/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1487677248000},{"_id":"themes/clean-blog/.git/hooks/pre-rebase.sample","hash":"5885a56ab4fca8075a05a562d005e922cde9853b","modified":1487677248000},{"_id":"themes/clean-blog/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1487677248000},{"_id":"themes/clean-blog/.git/hooks/prepare-commit-msg.sample","hash":"2b6275eda365cad50d167fe3a387c9bc9fedd54f","modified":1487677248000},{"_id":"themes/clean-blog/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1487677248000},{"_id":"themes/clean-blog/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1487677248000},{"_id":"themes/clean-blog/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1487677248000},{"_id":"themes/clean-blog/.git/logs/HEAD","hash":"cd27109306992de90def496e87086fdeb50d80c6","modified":1487677529000},{"_id":"themes/clean-blog/layout/_partial/after-footer.ejs","hash":"80970a6cfbf9b1abe0c472636b321a9be08fdc43","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/article-archive.ejs","hash":"3d8d98c6545b8332a6d6ed4f8b00327df03ea945","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/article-categories.ejs","hash":"5a0bf5a20f670621d8013c9b9d7976b45c8aa80f","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/article-full.ejs","hash":"8d63ce240bbcc850b5d438d1f45ad9441ac1c9cc","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/article-index.ejs","hash":"e433df4e245e2d4c628052c6e59966563542d94d","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/article-tags.ejs","hash":"6136434be09056c1466149cecb3cc2e80d107999","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/comments.ejs","hash":"3fedb75436439d1d6979b7e4d20d48a593e12be4","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/footer.ejs","hash":"d252fb1a41890e6481bb054f9cc4ceec3c0b0ed9","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/gallery.ejs","hash":"21e4f28909f4a79ff7d9f10bdfef6a8cb11632bf","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/google-analytics.ejs","hash":"4e6e8de9becea5a1636a4dcadcf7a10c06e2426e","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/head.ejs","hash":"3a7eb32f2cc540746c9e11010a4513b832743d1e","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/menu.ejs","hash":"ba299316400499e9ede154e9627cafb7ce411888","modified":1487677253000},{"_id":"themes/clean-blog/layout/_partial/pagination.ejs","hash":"557d6bb069a1d48af49ae912994653f44b32a570","modified":1487677253000},{"_id":"themes/clean-blog/source/css/mixins.styl","hash":"892f55e8a71f2e23a52e48e217dad3303bbad913","modified":1487677253000},{"_id":"themes/clean-blog/source/css/article.styl","hash":"8e0239f417b2bd464455e98b6a350ae7e47c3cf1","modified":1487677253000},{"_id":"themes/clean-blog/source/css/base.styl","hash":"f0a6fcf58fe515e1359acde0ed34081f580ec7a3","modified":1487677253000},{"_id":"themes/clean-blog/source/css/style.styl","hash":"c40dc495a41007d21c59f342ee42b2d31d7b5ff4","modified":1487677253000},{"_id":"themes/clean-blog/source/css/variables.styl","hash":"cd82df5ca8dfbcfec12d833f01adfac00878e835","modified":1487677253000},{"_id":"themes/clean-blog/source/img/about-bg.jpg","hash":"d39126a6456f2bac0169d1779304725f179c9900","modified":1487677253000},{"_id":"themes/clean-blog/.git/objects/pack/pack-ba9c1db2f1d721a95e30c8ec21a394064760cf5a.idx","hash":"ebb1f5e6b39003ff3fa53cb0cf0df3aa9d7c8339","modified":1487677253000},{"_id":"themes/clean-blog/.git/refs/heads/master","hash":"308eafa1f684ac2b524818018028f25ad0c29cb2","modified":1487677253000},{"_id":"themes/clean-blog/source/img/home-bg.jpg","hash":"990f6f9dd0ecb5348bfcc47305553d58c0d8f326","modified":1487677253000},{"_id":"themes/clean-blog/.git/logs/refs/heads/master","hash":"096bb4ddebc865cc1ff14e96697a9c87b26a39cf","modified":1487677253000},{"_id":"themes/clean-blog/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1487677253000},{"_id":"themes/clean-blog/source/img/contact-bg.jpg","hash":"6af63305c923899017e727b5ca968a2703bc08cf","modified":1487677253000},{"_id":"themes/clean-blog/.git/logs/refs/remotes/origin/HEAD","hash":"096bb4ddebc865cc1ff14e96697a9c87b26a39cf","modified":1487677253000},{"_id":"themes/clean-blog/.git/objects/pack/pack-ba9c1db2f1d721a95e30c8ec21a394064760cf5a.pack","hash":"d10424be4a3eefd00cb01e2fec67fadad1a2d8c1","modified":1487677253000},{"_id":"source/_posts/.DS_Store","hash":"9f6108ba1f29150ba38dd48d99c3425d598fa682","modified":1487692667000},{"_id":"source/_posts/20170221/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1487684922000},{"_id":"source/_posts/20170221/1-2.png","hash":"74700170ad07b509076fcdcb2ce030b9b19f297a","modified":1487684866000},{"_id":"source/_posts/20170221/1-3.png","hash":"e91ee0637a53311fb5c51d6eaabc4dc4f27f7076","modified":1487684897000},{"_id":"source/_posts/20170221/0.png","hash":"91a1b8967f9c5f89d1fdcbce739c3db743ff4dd4","modified":1487683642000}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"オリジナルgulpfileを書くのは悪い文明","date":"2016-12-03T14:22:36.000Z","_content":"\n","source":"_drafts/20161203.md","raw":"---\ntitle: オリジナルgulpfileを書くのは悪い文明\ndate: 2016-12-03 23:22:36\npermalink: 1\ntags:\n - Gulp\n---\n\n","slug":"1","published":0,"updated":"2017-02-21T11:56:03.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cizfk5cnh0000thc1x5mvgonq","content":"","excerpt":"","more":""},{"title":"デレステのドレスショップは私の説得に失敗しました","description":"がっかりだよ","date":"2017-02-15T07:07:25.000Z","_content":"\nツイートだと上手くまとまらないため古式ゆかしくブログに時系列で書きます。\n\n## ドレスショップの事前予想\n\n「ドレスショップ」という単語が出てきた時点で、その名称から以下のような予想を立てました。\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステの衣装の件、ドレスショップという名前がひっかかる。グラブルはスキン販売という名目で実質的に期間限定のガチャチケットを売っているけど、常設のショップとなると方向が違う。「アイドル一人ずつ購入、一回あたり石500 (ガチャなし)」みたいなエグいことになったり…</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/829881864131260416\">2017年2月10日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n**「これは高いヤツだ」と思った**わけですね。そこは実際その通りになりました。\n\n以前からデレステについて「製造コストのわりに購買層が薄く、売り上げが小さすぎる (このままだとSSR 3週目が出るか怪しい)」と予想していたので、**ようやくガシャ以外の課金要素を強化するのか**という感覚でした。\n\n「購入方法は有償ジュエル限定か？」という点はあまり意識していませんでしたが、少なくとも全員衣装は有償だろうなーと思っていました。\n\n## 実際のドレスショップ\n\nどうもプレイヤーごとに認識のズレがあるようなので、最初に整理しておきます。\n\n* \"Snow Wings\" ユニット衣装を着たのは唯・凛・未央の3人\n    * 卯月・春菜はあの白い衣装を着たイラストがそもそも無い\n    * 2人は赤いサンタ風コスチュームでした \n* **イラストにおける唯・凛・未央の衣装には差分がある**\n    * どのくらい違うかというと **LiPPSの衣装と同じくらい** 違う\n    * 凛: シンプルなドレス風。長手袋と小さめのリボンでCoらしく纏めつつ、ノースリーブとスカートのポンポンで軽やかさと華やかさも演出\n    * 未央: ヘソ出しパーカー風。胸元に緑・赤・黄と色が多く、華やかで元気。いかにもPaらしくアレンジしてあるが、その結果としてパーカーになるのは未央ならでは\n    * 唯: ヘソ出しユニフォーム風。ジャケットなしでノースリーブだが、マントのようなポンチョのような名状しがたい何かを着用。髪飾り・マイク・胸元とあっちこっちに細かいアクセサリーがあり、長めのリボンと髪がかなり自由に動きそう\n* ドレスショップで売っているのは**オリジナルの衣装とは別物の「3人の衣装を足して3で割った」といった具合の新しい共通衣装**\n    * 全体的に近いのは凛のドレス\n    * 未央のパーカー (胴体部分のみ) を脱色して追加\n    * 唯のリボンを切り取って追加\n\nこちら時価3000円相当となっております。はてさて…\n\n## 感想\n\n以下、私の心の変遷をお愉しみください。\n\n### 全員じゃないのか…\nユニット限定で実装… いきなりそっちで来るとは予想外…\n\n### 仕方ないなあ…\n\n3Dモデルを作るの大変だからな。ユニットのアイドル限定で実装するのは仕方ないかな！ ちょっと高い気もするけどな！ \n\n### いや、でもやっぱり全員がよかったなあ…\n\n理屈は分かるんだけれども。うーん。\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステくんのドレスショップは「有償石2500で、ユニット衣装を購入できて、全員に着せられて、オリジナルのメンバーには特別なアクセサリーや調整が入る」という仕様なら1秒で課金していた</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831400559823368192\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕はデレステにしろモバマスにしろ、シンデレラガールズ全員に開かれたコンテンツであって欲しいんです。声つきガールズのコンテンツは欲しくないんです</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831401981247787008\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\nま、そうは言っても現実は厳しいよね。それは仕方ない。商売だし。\n\n少なくとも、オリジナルメンバーは特別扱いでも仕方ない。というか、むしろ当然のこととして特別扱いをしてほしい。だってメンバーに限ってはイラストを忠実に再現したモデリングで動くんでしょ？ 超羨ましい… イラスト再現羨ましい… うらやま… \n\nあれ？\n\n### 君なんかイラストと違わない？\n\n今までデレステのSSRはちゃんとイラストを再現していたので、**「イラストと全然違うモデルが実装されるかもしれない」という発想をすっかり失っていました**。それで最初は気付かなかったんですが、どうも様子がおかしい。\n\nそれからイベント時のイラストと比べたり、担当Pのツイートを拾ったりして、まあ驚愕したわけですよ。だってこれ**全然違う**んだもの。\n\n今までずっとSSRのクオリティが高かったから、**イラストを再現していると信用して買うか買わないか考えていたけど、調べてみたら全然違う**じゃん！ ナニコレ！\n\n### このクオリティで5人限定3000円は出せない\n\n「こんな雑なモデリングで5人限定って商品の趣旨わかんないんですけど」という気持ちまっしぐら！\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">衣装の差分まで再現して5人限定か、差分を省いて全員か、その合わせ技で二重底の価格設定か、そのどれかなら僕も課金していたのに、実際は「差分は無視するのに5人限定で一律課金」という… 本当にもう… もうね</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831523311859273729\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">前者で納得させようという努力の片鱗も見えないから不機嫌なんです。ユニット共通衣装でも5人それぞれ違いのはっきりある衣装なら「これなら5人限定でも仕方ないな」と思うけど、今回の衣装は…</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831435740793827328\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n### 一挙に疑心暗鬼へ\n\nもうブログ書くのも嫌だからツイート貼っ付けるネ。\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕個人の職業柄「ボイスつきアイドルにSSR 3人目を出すとユーザーから袋叩きにされるから、ドレスショップ経由で実質的に出しちゃおう」みたいな営業戦略会議を幻視してしまい、デレステを素直な目で見られません</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831443411051753472\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステくんの言う全員が使える衣装ってたぶんハイファイデイズの衣装だよね。L.M.B.G. との兼ね合いで</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831446671791792128\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">単純にモバPは目が悪いから気づいてない可能性もあるけど、LiPPSの衣装は色違いではない… でもこのままだと確実に2Pカラーとして実装される</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831501614426910721\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">衣装の個性を再現せず5人限定にする意味が分からない</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831523845752320001\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">ドレスショップに「なんかブルナポっぽい匿名の衣装」が「ブルナポの衣装」として「ブルナポ限定」で追加されても何にも嬉しくないじゃん。全員共通なら全員で着てほしいし、ブルナポ限定ならちゃんと再現してほしい</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831524606393536513\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕はもう今のドレスショップにブルナポの衣装が実装されないことを祈ることしかできない… 5人の個性と引き換えの衣装はいらない</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831534106869510144\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n## デレステくんに言いたいこと\n\nありません。出直してきてください。\n\n## 反論キッズへの予防線\n\n* 私の課金額は6桁円です\n* 全員分の衣装も追加予定？ その衣装が追加されてもSnow Wingsのイラストは永久に再現されませんよね\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">「ドレスショップは3000円で実質的にSSRが買える」と擁護してみても、デレステは正にそのSSRが3000円で買えるわけで、イラスト再現度の低い謎衣装のSSR擬きを同じ値段で買う理由は全く見当たらない… 値段設定がそもそもおかしい</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831750239652605953\">2017年2月15日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n以上です。","source":"_drafts/20170215.md","raw":"---\ntitle: デレステのドレスショップは私の説得に失敗しました\npermalink: 1\ndescription: がっかりだよ\ndate: 2017-02-15 16:07:25\ntags:\n---\n\nツイートだと上手くまとまらないため古式ゆかしくブログに時系列で書きます。\n\n## ドレスショップの事前予想\n\n「ドレスショップ」という単語が出てきた時点で、その名称から以下のような予想を立てました。\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステの衣装の件、ドレスショップという名前がひっかかる。グラブルはスキン販売という名目で実質的に期間限定のガチャチケットを売っているけど、常設のショップとなると方向が違う。「アイドル一人ずつ購入、一回あたり石500 (ガチャなし)」みたいなエグいことになったり…</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/829881864131260416\">2017年2月10日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n**「これは高いヤツだ」と思った**わけですね。そこは実際その通りになりました。\n\n以前からデレステについて「製造コストのわりに購買層が薄く、売り上げが小さすぎる (このままだとSSR 3週目が出るか怪しい)」と予想していたので、**ようやくガシャ以外の課金要素を強化するのか**という感覚でした。\n\n「購入方法は有償ジュエル限定か？」という点はあまり意識していませんでしたが、少なくとも全員衣装は有償だろうなーと思っていました。\n\n## 実際のドレスショップ\n\nどうもプレイヤーごとに認識のズレがあるようなので、最初に整理しておきます。\n\n* \"Snow Wings\" ユニット衣装を着たのは唯・凛・未央の3人\n    * 卯月・春菜はあの白い衣装を着たイラストがそもそも無い\n    * 2人は赤いサンタ風コスチュームでした \n* **イラストにおける唯・凛・未央の衣装には差分がある**\n    * どのくらい違うかというと **LiPPSの衣装と同じくらい** 違う\n    * 凛: シンプルなドレス風。長手袋と小さめのリボンでCoらしく纏めつつ、ノースリーブとスカートのポンポンで軽やかさと華やかさも演出\n    * 未央: ヘソ出しパーカー風。胸元に緑・赤・黄と色が多く、華やかで元気。いかにもPaらしくアレンジしてあるが、その結果としてパーカーになるのは未央ならでは\n    * 唯: ヘソ出しユニフォーム風。ジャケットなしでノースリーブだが、マントのようなポンチョのような名状しがたい何かを着用。髪飾り・マイク・胸元とあっちこっちに細かいアクセサリーがあり、長めのリボンと髪がかなり自由に動きそう\n* ドレスショップで売っているのは**オリジナルの衣装とは別物の「3人の衣装を足して3で割った」といった具合の新しい共通衣装**\n    * 全体的に近いのは凛のドレス\n    * 未央のパーカー (胴体部分のみ) を脱色して追加\n    * 唯のリボンを切り取って追加\n\nこちら時価3000円相当となっております。はてさて…\n\n## 感想\n\n以下、私の心の変遷をお愉しみください。\n\n### 全員じゃないのか…\nユニット限定で実装… いきなりそっちで来るとは予想外…\n\n### 仕方ないなあ…\n\n3Dモデルを作るの大変だからな。ユニットのアイドル限定で実装するのは仕方ないかな！ ちょっと高い気もするけどな！ \n\n### いや、でもやっぱり全員がよかったなあ…\n\n理屈は分かるんだけれども。うーん。\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステくんのドレスショップは「有償石2500で、ユニット衣装を購入できて、全員に着せられて、オリジナルのメンバーには特別なアクセサリーや調整が入る」という仕様なら1秒で課金していた</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831400559823368192\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕はデレステにしろモバマスにしろ、シンデレラガールズ全員に開かれたコンテンツであって欲しいんです。声つきガールズのコンテンツは欲しくないんです</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831401981247787008\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\nま、そうは言っても現実は厳しいよね。それは仕方ない。商売だし。\n\n少なくとも、オリジナルメンバーは特別扱いでも仕方ない。というか、むしろ当然のこととして特別扱いをしてほしい。だってメンバーに限ってはイラストを忠実に再現したモデリングで動くんでしょ？ 超羨ましい… イラスト再現羨ましい… うらやま… \n\nあれ？\n\n### 君なんかイラストと違わない？\n\n今までデレステのSSRはちゃんとイラストを再現していたので、**「イラストと全然違うモデルが実装されるかもしれない」という発想をすっかり失っていました**。それで最初は気付かなかったんですが、どうも様子がおかしい。\n\nそれからイベント時のイラストと比べたり、担当Pのツイートを拾ったりして、まあ驚愕したわけですよ。だってこれ**全然違う**んだもの。\n\n今までずっとSSRのクオリティが高かったから、**イラストを再現していると信用して買うか買わないか考えていたけど、調べてみたら全然違う**じゃん！ ナニコレ！\n\n### このクオリティで5人限定3000円は出せない\n\n「こんな雑なモデリングで5人限定って商品の趣旨わかんないんですけど」という気持ちまっしぐら！\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">衣装の差分まで再現して5人限定か、差分を省いて全員か、その合わせ技で二重底の価格設定か、そのどれかなら僕も課金していたのに、実際は「差分は無視するのに5人限定で一律課金」という… 本当にもう… もうね</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831523311859273729\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">前者で納得させようという努力の片鱗も見えないから不機嫌なんです。ユニット共通衣装でも5人それぞれ違いのはっきりある衣装なら「これなら5人限定でも仕方ないな」と思うけど、今回の衣装は…</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831435740793827328\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n### 一挙に疑心暗鬼へ\n\nもうブログ書くのも嫌だからツイート貼っ付けるネ。\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕個人の職業柄「ボイスつきアイドルにSSR 3人目を出すとユーザーから袋叩きにされるから、ドレスショップ経由で実質的に出しちゃおう」みたいな営業戦略会議を幻視してしまい、デレステを素直な目で見られません</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831443411051753472\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステくんの言う全員が使える衣装ってたぶんハイファイデイズの衣装だよね。L.M.B.G. との兼ね合いで</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831446671791792128\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">単純にモバPは目が悪いから気づいてない可能性もあるけど、LiPPSの衣装は色違いではない… でもこのままだと確実に2Pカラーとして実装される</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831501614426910721\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">衣装の個性を再現せず5人限定にする意味が分からない</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831523845752320001\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">ドレスショップに「なんかブルナポっぽい匿名の衣装」が「ブルナポの衣装」として「ブルナポ限定」で追加されても何にも嬉しくないじゃん。全員共通なら全員で着てほしいし、ブルナポ限定ならちゃんと再現してほしい</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831524606393536513\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕はもう今のドレスショップにブルナポの衣装が実装されないことを祈ることしかできない… 5人の個性と引き換えの衣装はいらない</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831534106869510144\">2017年2月14日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n## デレステくんに言いたいこと\n\nありません。出直してきてください。\n\n## 反論キッズへの予防線\n\n* 私の課金額は6桁円です\n* 全員分の衣装も追加予定？ その衣装が追加されてもSnow Wingsのイラストは永久に再現されませんよね\n\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">「ドレスショップは3000円で実質的にSSRが買える」と擁護してみても、デレステは正にそのSSRが3000円で買えるわけで、イラスト再現度の低い謎衣装のSSR擬きを同じ値段で買う理由は全く見当たらない… 値段設定がそもそもおかしい</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831750239652605953\">2017年2月15日</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n以上です。","slug":"1","published":0,"updated":"2017-02-21T11:56:03.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cizfk5cnp0001thc1qoar83ki","content":"<p>ツイートだと上手くまとまらないため古式ゆかしくブログに時系列で書きます。</p>\n<h2 id=\"ドレスショップの事前予想\"><a href=\"#ドレスショップの事前予想\" class=\"headerlink\" title=\"ドレスショップの事前予想\"></a>ドレスショップの事前予想</h2><p>「ドレスショップ」という単語が出てきた時点で、その名称から以下のような予想を立てました。</p>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステの衣装の件、ドレスショップという名前がひっかかる。グラブルはスキン販売という名目で実質的に期間限定のガチャチケットを売っているけど、常設のショップとなると方向が違う。「アイドル一人ずつ購入、一回あたり石500 (ガチャなし)」みたいなエグいことになったり…</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/829881864131260416\" target=\"_blank\" rel=\"external\">2017年2月10日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><strong>「これは高いヤツだ」と思った</strong>わけですね。そこは実際その通りになりました。</p>\n<p>以前からデレステについて「製造コストのわりに購買層が薄く、売り上げが小さすぎる (このままだとSSR 3週目が出るか怪しい)」と予想していたので、<strong>ようやくガシャ以外の課金要素を強化するのか</strong>という感覚でした。</p>\n<p>「購入方法は有償ジュエル限定か？」という点はあまり意識していませんでしたが、少なくとも全員衣装は有償だろうなーと思っていました。</p>\n<h2 id=\"実際のドレスショップ\"><a href=\"#実際のドレスショップ\" class=\"headerlink\" title=\"実際のドレスショップ\"></a>実際のドレスショップ</h2><p>どうもプレイヤーごとに認識のズレがあるようなので、最初に整理しておきます。</p>\n<ul>\n<li>“Snow Wings” ユニット衣装を着たのは唯・凛・未央の3人<ul>\n<li>卯月・春菜はあの白い衣装を着たイラストがそもそも無い</li>\n<li>2人は赤いサンタ風コスチュームでした </li>\n</ul>\n</li>\n<li><strong>イラストにおける唯・凛・未央の衣装には差分がある</strong><ul>\n<li>どのくらい違うかというと <strong>LiPPSの衣装と同じくらい</strong> 違う</li>\n<li>凛: シンプルなドレス風。長手袋と小さめのリボンでCoらしく纏めつつ、ノースリーブとスカートのポンポンで軽やかさと華やかさも演出</li>\n<li>未央: ヘソ出しパーカー風。胸元に緑・赤・黄と色が多く、華やかで元気。いかにもPaらしくアレンジしてあるが、その結果としてパーカーになるのは未央ならでは</li>\n<li>唯: ヘソ出しユニフォーム風。ジャケットなしでノースリーブだが、マントのようなポンチョのような名状しがたい何かを着用。髪飾り・マイク・胸元とあっちこっちに細かいアクセサリーがあり、長めのリボンと髪がかなり自由に動きそう</li>\n</ul>\n</li>\n<li>ドレスショップで売っているのは<strong>オリジナルの衣装とは別物の「3人の衣装を足して3で割った」といった具合の新しい共通衣装</strong><ul>\n<li>全体的に近いのは凛のドレス</li>\n<li>未央のパーカー (胴体部分のみ) を脱色して追加</li>\n<li>唯のリボンを切り取って追加</li>\n</ul>\n</li>\n</ul>\n<p>こちら時価3000円相当となっております。はてさて…</p>\n<h2 id=\"感想\"><a href=\"#感想\" class=\"headerlink\" title=\"感想\"></a>感想</h2><p>以下、私の心の変遷をお愉しみください。</p>\n<h3 id=\"全員じゃないのか…\"><a href=\"#全員じゃないのか…\" class=\"headerlink\" title=\"全員じゃないのか…\"></a>全員じゃないのか…</h3><p>ユニット限定で実装… いきなりそっちで来るとは予想外…</p>\n<h3 id=\"仕方ないなあ…\"><a href=\"#仕方ないなあ…\" class=\"headerlink\" title=\"仕方ないなあ…\"></a>仕方ないなあ…</h3><p>3Dモデルを作るの大変だからな。ユニットのアイドル限定で実装するのは仕方ないかな！ ちょっと高い気もするけどな！ </p>\n<h3 id=\"いや、でもやっぱり全員がよかったなあ…\"><a href=\"#いや、でもやっぱり全員がよかったなあ…\" class=\"headerlink\" title=\"いや、でもやっぱり全員がよかったなあ…\"></a>いや、でもやっぱり全員がよかったなあ…</h3><p>理屈は分かるんだけれども。うーん。</p>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステくんのドレスショップは「有償石2500で、ユニット衣装を購入できて、全員に着せられて、オリジナルのメンバーには特別なアクセサリーや調整が入る」という仕様なら1秒で課金していた</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831400559823368192\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕はデレステにしろモバマスにしろ、シンデレラガールズ全員に開かれたコンテンツであって欲しいんです。声つきガールズのコンテンツは欲しくないんです</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831401981247787008\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p>ま、そうは言っても現実は厳しいよね。それは仕方ない。商売だし。</p>\n<p>少なくとも、オリジナルメンバーは特別扱いでも仕方ない。というか、むしろ当然のこととして特別扱いをしてほしい。だってメンバーに限ってはイラストを忠実に再現したモデリングで動くんでしょ？ 超羨ましい… イラスト再現羨ましい… うらやま… </p>\n<p>あれ？</p>\n<h3 id=\"君なんかイラストと違わない？\"><a href=\"#君なんかイラストと違わない？\" class=\"headerlink\" title=\"君なんかイラストと違わない？\"></a>君なんかイラストと違わない？</h3><p>今までデレステのSSRはちゃんとイラストを再現していたので、<strong>「イラストと全然違うモデルが実装されるかもしれない」という発想をすっかり失っていました</strong>。それで最初は気付かなかったんですが、どうも様子がおかしい。</p>\n<p>それからイベント時のイラストと比べたり、担当Pのツイートを拾ったりして、まあ驚愕したわけですよ。だってこれ<strong>全然違う</strong>んだもの。</p>\n<p>今までずっとSSRのクオリティが高かったから、<strong>イラストを再現していると信用して買うか買わないか考えていたけど、調べてみたら全然違う</strong>じゃん！ ナニコレ！</p>\n<h3 id=\"このクオリティで5人限定3000円は出せない\"><a href=\"#このクオリティで5人限定3000円は出せない\" class=\"headerlink\" title=\"このクオリティで5人限定3000円は出せない\"></a>このクオリティで5人限定3000円は出せない</h3><p>「こんな雑なモデリングで5人限定って商品の趣旨わかんないんですけど」という気持ちまっしぐら！</p>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">衣装の差分まで再現して5人限定か、差分を省いて全員か、その合わせ技で二重底の価格設定か、そのどれかなら僕も課金していたのに、実際は「差分は無視するのに5人限定で一律課金」という… 本当にもう… もうね</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831523311859273729\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">前者で納得させようという努力の片鱗も見えないから不機嫌なんです。ユニット共通衣装でも5人それぞれ違いのはっきりある衣装なら「これなら5人限定でも仕方ないな」と思うけど、今回の衣装は…</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831435740793827328\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<h3 id=\"一挙に疑心暗鬼へ\"><a href=\"#一挙に疑心暗鬼へ\" class=\"headerlink\" title=\"一挙に疑心暗鬼へ\"></a>一挙に疑心暗鬼へ</h3><p>もうブログ書くのも嫌だからツイート貼っ付けるネ。</p>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕個人の職業柄「ボイスつきアイドルにSSR 3人目を出すとユーザーから袋叩きにされるから、ドレスショップ経由で実質的に出しちゃおう」みたいな営業戦略会議を幻視してしまい、デレステを素直な目で見られません</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831443411051753472\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステくんの言う全員が使える衣装ってたぶんハイファイデイズの衣装だよね。L.M.B.G. との兼ね合いで</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831446671791792128\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">単純にモバPは目が悪いから気づいてない可能性もあるけど、LiPPSの衣装は色違いではない… でもこのままだと確実に2Pカラーとして実装される</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831501614426910721\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">衣装の個性を再現せず5人限定にする意味が分からない</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831523845752320001\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">ドレスショップに「なんかブルナポっぽい匿名の衣装」が「ブルナポの衣装」として「ブルナポ限定」で追加されても何にも嬉しくないじゃん。全員共通なら全員で着てほしいし、ブルナポ限定ならちゃんと再現してほしい</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831524606393536513\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕はもう今のドレスショップにブルナポの衣装が実装されないことを祈ることしかできない… 5人の個性と引き換えの衣装はいらない</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831534106869510144\" target=\"_blank\" rel=\"external\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<h2 id=\"デレステくんに言いたいこと\"><a href=\"#デレステくんに言いたいこと\" class=\"headerlink\" title=\"デレステくんに言いたいこと\"></a>デレステくんに言いたいこと</h2><p>ありません。出直してきてください。</p>\n<h2 id=\"反論キッズへの予防線\"><a href=\"#反論キッズへの予防線\" class=\"headerlink\" title=\"反論キッズへの予防線\"></a>反論キッズへの予防線</h2><ul>\n<li>私の課金額は6桁円です</li>\n<li>全員分の衣装も追加予定？ その衣装が追加されてもSnow Wingsのイラストは永久に再現されませんよね</li>\n</ul>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">「ドレスショップは3000円で実質的にSSRが買える」と擁護してみても、デレステは正にそのSSRが3000円で買えるわけで、イラスト再現度の低い謎衣装のSSR擬きを同じ値段で買う理由は全く見当たらない… 値段設定がそもそもおかしい</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831750239652605953\" target=\"_blank\" rel=\"external\">2017年2月15日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p>以上です。</p>\n","excerpt":"","more":"<p>ツイートだと上手くまとまらないため古式ゆかしくブログに時系列で書きます。</p>\n<h2 id=\"ドレスショップの事前予想\"><a href=\"#ドレスショップの事前予想\" class=\"headerlink\" title=\"ドレスショップの事前予想\"></a>ドレスショップの事前予想</h2><p>「ドレスショップ」という単語が出てきた時点で、その名称から以下のような予想を立てました。</p>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステの衣装の件、ドレスショップという名前がひっかかる。グラブルはスキン販売という名目で実質的に期間限定のガチャチケットを売っているけど、常設のショップとなると方向が違う。「アイドル一人ずつ購入、一回あたり石500 (ガチャなし)」みたいなエグいことになったり…</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/829881864131260416\">2017年2月10日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><strong>「これは高いヤツだ」と思った</strong>わけですね。そこは実際その通りになりました。</p>\n<p>以前からデレステについて「製造コストのわりに購買層が薄く、売り上げが小さすぎる (このままだとSSR 3週目が出るか怪しい)」と予想していたので、<strong>ようやくガシャ以外の課金要素を強化するのか</strong>という感覚でした。</p>\n<p>「購入方法は有償ジュエル限定か？」という点はあまり意識していませんでしたが、少なくとも全員衣装は有償だろうなーと思っていました。</p>\n<h2 id=\"実際のドレスショップ\"><a href=\"#実際のドレスショップ\" class=\"headerlink\" title=\"実際のドレスショップ\"></a>実際のドレスショップ</h2><p>どうもプレイヤーごとに認識のズレがあるようなので、最初に整理しておきます。</p>\n<ul>\n<li>“Snow Wings” ユニット衣装を着たのは唯・凛・未央の3人<ul>\n<li>卯月・春菜はあの白い衣装を着たイラストがそもそも無い</li>\n<li>2人は赤いサンタ風コスチュームでした </li>\n</ul>\n</li>\n<li><strong>イラストにおける唯・凛・未央の衣装には差分がある</strong><ul>\n<li>どのくらい違うかというと <strong>LiPPSの衣装と同じくらい</strong> 違う</li>\n<li>凛: シンプルなドレス風。長手袋と小さめのリボンでCoらしく纏めつつ、ノースリーブとスカートのポンポンで軽やかさと華やかさも演出</li>\n<li>未央: ヘソ出しパーカー風。胸元に緑・赤・黄と色が多く、華やかで元気。いかにもPaらしくアレンジしてあるが、その結果としてパーカーになるのは未央ならでは</li>\n<li>唯: ヘソ出しユニフォーム風。ジャケットなしでノースリーブだが、マントのようなポンチョのような名状しがたい何かを着用。髪飾り・マイク・胸元とあっちこっちに細かいアクセサリーがあり、長めのリボンと髪がかなり自由に動きそう</li>\n</ul>\n</li>\n<li>ドレスショップで売っているのは<strong>オリジナルの衣装とは別物の「3人の衣装を足して3で割った」といった具合の新しい共通衣装</strong><ul>\n<li>全体的に近いのは凛のドレス</li>\n<li>未央のパーカー (胴体部分のみ) を脱色して追加</li>\n<li>唯のリボンを切り取って追加</li>\n</ul>\n</li>\n</ul>\n<p>こちら時価3000円相当となっております。はてさて…</p>\n<h2 id=\"感想\"><a href=\"#感想\" class=\"headerlink\" title=\"感想\"></a>感想</h2><p>以下、私の心の変遷をお愉しみください。</p>\n<h3 id=\"全員じゃないのか…\"><a href=\"#全員じゃないのか…\" class=\"headerlink\" title=\"全員じゃないのか…\"></a>全員じゃないのか…</h3><p>ユニット限定で実装… いきなりそっちで来るとは予想外…</p>\n<h3 id=\"仕方ないなあ…\"><a href=\"#仕方ないなあ…\" class=\"headerlink\" title=\"仕方ないなあ…\"></a>仕方ないなあ…</h3><p>3Dモデルを作るの大変だからな。ユニットのアイドル限定で実装するのは仕方ないかな！ ちょっと高い気もするけどな！ </p>\n<h3 id=\"いや、でもやっぱり全員がよかったなあ…\"><a href=\"#いや、でもやっぱり全員がよかったなあ…\" class=\"headerlink\" title=\"いや、でもやっぱり全員がよかったなあ…\"></a>いや、でもやっぱり全員がよかったなあ…</h3><p>理屈は分かるんだけれども。うーん。</p>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステくんのドレスショップは「有償石2500で、ユニット衣装を購入できて、全員に着せられて、オリジナルのメンバーには特別なアクセサリーや調整が入る」という仕様なら1秒で課金していた</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831400559823368192\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕はデレステにしろモバマスにしろ、シンデレラガールズ全員に開かれたコンテンツであって欲しいんです。声つきガールズのコンテンツは欲しくないんです</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831401981247787008\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p>ま、そうは言っても現実は厳しいよね。それは仕方ない。商売だし。</p>\n<p>少なくとも、オリジナルメンバーは特別扱いでも仕方ない。というか、むしろ当然のこととして特別扱いをしてほしい。だってメンバーに限ってはイラストを忠実に再現したモデリングで動くんでしょ？ 超羨ましい… イラスト再現羨ましい… うらやま… </p>\n<p>あれ？</p>\n<h3 id=\"君なんかイラストと違わない？\"><a href=\"#君なんかイラストと違わない？\" class=\"headerlink\" title=\"君なんかイラストと違わない？\"></a>君なんかイラストと違わない？</h3><p>今までデレステのSSRはちゃんとイラストを再現していたので、<strong>「イラストと全然違うモデルが実装されるかもしれない」という発想をすっかり失っていました</strong>。それで最初は気付かなかったんですが、どうも様子がおかしい。</p>\n<p>それからイベント時のイラストと比べたり、担当Pのツイートを拾ったりして、まあ驚愕したわけですよ。だってこれ<strong>全然違う</strong>んだもの。</p>\n<p>今までずっとSSRのクオリティが高かったから、<strong>イラストを再現していると信用して買うか買わないか考えていたけど、調べてみたら全然違う</strong>じゃん！ ナニコレ！</p>\n<h3 id=\"このクオリティで5人限定3000円は出せない\"><a href=\"#このクオリティで5人限定3000円は出せない\" class=\"headerlink\" title=\"このクオリティで5人限定3000円は出せない\"></a>このクオリティで5人限定3000円は出せない</h3><p>「こんな雑なモデリングで5人限定って商品の趣旨わかんないんですけど」という気持ちまっしぐら！</p>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">衣装の差分まで再現して5人限定か、差分を省いて全員か、その合わせ技で二重底の価格設定か、そのどれかなら僕も課金していたのに、実際は「差分は無視するのに5人限定で一律課金」という… 本当にもう… もうね</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831523311859273729\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">前者で納得させようという努力の片鱗も見えないから不機嫌なんです。ユニット共通衣装でも5人それぞれ違いのはっきりある衣装なら「これなら5人限定でも仕方ないな」と思うけど、今回の衣装は…</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831435740793827328\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<h3 id=\"一挙に疑心暗鬼へ\"><a href=\"#一挙に疑心暗鬼へ\" class=\"headerlink\" title=\"一挙に疑心暗鬼へ\"></a>一挙に疑心暗鬼へ</h3><p>もうブログ書くのも嫌だからツイート貼っ付けるネ。</p>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕個人の職業柄「ボイスつきアイドルにSSR 3人目を出すとユーザーから袋叩きにされるから、ドレスショップ経由で実質的に出しちゃおう」みたいな営業戦略会議を幻視してしまい、デレステを素直な目で見られません</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831443411051753472\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">デレステくんの言う全員が使える衣装ってたぶんハイファイデイズの衣装だよね。L.M.B.G. との兼ね合いで</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831446671791792128\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">単純にモバPは目が悪いから気づいてない可能性もあるけど、LiPPSの衣装は色違いではない… でもこのままだと確実に2Pカラーとして実装される</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831501614426910721\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">衣装の個性を再現せず5人限定にする意味が分からない</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831523845752320001\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">ドレスショップに「なんかブルナポっぽい匿名の衣装」が「ブルナポの衣装」として「ブルナポ限定」で追加されても何にも嬉しくないじゃん。全員共通なら全員で着てほしいし、ブルナポ限定ならちゃんと再現してほしい</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831524606393536513\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">僕はもう今のドレスショップにブルナポの衣装が実装されないことを祈ることしかできない… 5人の個性と引き換えの衣装はいらない</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831534106869510144\">2017年2月14日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<h2 id=\"デレステくんに言いたいこと\"><a href=\"#デレステくんに言いたいこと\" class=\"headerlink\" title=\"デレステくんに言いたいこと\"></a>デレステくんに言いたいこと</h2><p>ありません。出直してきてください。</p>\n<h2 id=\"反論キッズへの予防線\"><a href=\"#反論キッズへの予防線\" class=\"headerlink\" title=\"反論キッズへの予防線\"></a>反論キッズへの予防線</h2><ul>\n<li>私の課金額は6桁円です</li>\n<li>全員分の衣装も追加予定？ その衣装が追加されてもSnow Wingsのイラストは永久に再現されませんよね</li>\n</ul>\n<p><blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">「ドレスショップは3000円で実質的にSSRが買える」と擁護してみても、デレステは正にそのSSRが3000円で買えるわけで、イラスト再現度の低い謎衣装のSSR擬きを同じ値段で買う理由は全く見当たらない… 値段設定がそもそもおかしい</p>&mdash; 椎茸くんです (@tottokotkd) <a href=\"https://twitter.com/tottokotkd/status/831750239652605953\">2017年2月15日</a></blockquote></p>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n<p>以上です。</p>\n"},{"title":"ドレスショップはなぜ「高い」のか","date":"2017-02-21T06:28:41.000Z","description":"デレステがこの先生きのこるには","_content":"\nドレスショップ5人限定3000円ですか。いやー高いっす。\n\nところで、この話題って二つの側面がありますよね。まず最初に、なぜガシャに財産を惜しまないユーザーが「3000円は高い」と感じるのか。不思議といえば不思議ですよね、10万に比べたら3000円なんて軽微な額ですもんね。\n\nもうひとつの側面は、なぜ運営が (ガシャチケットすらなしで) 3000円という価格設定にしたのか。これまでデレステはグラブルのグランデ (→トリコロール) とグラブルのサプチケ (→スカウトチケット) をフォローしてきたわけですから、普通に考えればグラブルのスキンを真似して「キャラ一人の固定衣装 + ガシャチケ」となりそうなものです。ところがそうなっていない。なんで今回に限ってそうじゃないのか。\n\nいちおう先に書いておきますけど以下の内容は全て妄想です。統計的根拠はないです。\n\n## なぜ「3000円は高い」のか\n\n### 1. スカチケより安くないから、高い\n\nあえて指摘するまでもないような話ですが、最大の要因はやはりデレステ自身が過去2回にわたって販売した「スカウトチケット」 (3000円) でしょう。\n\n* スカチケとは、3000円払うとガシャが回せて、そのうえ確定で好きなSSRを1枚もらえるという、射幸性の抑えられたステキな季節商品です。\n* SSRとは、ガシャでのみ入手できる、イラストを忠実に再現した3Dモデルつきのキャラクターです。ステータス・スキルが強力なので沢山いるとゲームが有利になります。\n\n\n## 運営が3000円で販売せざるを得ない要素","source":"_drafts/20170221.md","raw":"---\ntitle: ドレスショップはなぜ「高い」のか\npermalink: 1\ndate: 2017-02-21 15:28:41\ndescription: デレステがこの先生きのこるには\ntags:\n---\n\nドレスショップ5人限定3000円ですか。いやー高いっす。\n\nところで、この話題って二つの側面がありますよね。まず最初に、なぜガシャに財産を惜しまないユーザーが「3000円は高い」と感じるのか。不思議といえば不思議ですよね、10万に比べたら3000円なんて軽微な額ですもんね。\n\nもうひとつの側面は、なぜ運営が (ガシャチケットすらなしで) 3000円という価格設定にしたのか。これまでデレステはグラブルのグランデ (→トリコロール) とグラブルのサプチケ (→スカウトチケット) をフォローしてきたわけですから、普通に考えればグラブルのスキンを真似して「キャラ一人の固定衣装 + ガシャチケ」となりそうなものです。ところがそうなっていない。なんで今回に限ってそうじゃないのか。\n\nいちおう先に書いておきますけど以下の内容は全て妄想です。統計的根拠はないです。\n\n## なぜ「3000円は高い」のか\n\n### 1. スカチケより安くないから、高い\n\nあえて指摘するまでもないような話ですが、最大の要因はやはりデレステ自身が過去2回にわたって販売した「スカウトチケット」 (3000円) でしょう。\n\n* スカチケとは、3000円払うとガシャが回せて、そのうえ確定で好きなSSRを1枚もらえるという、射幸性の抑えられたステキな季節商品です。\n* SSRとは、ガシャでのみ入手できる、イラストを忠実に再現した3Dモデルつきのキャラクターです。ステータス・スキルが強力なので沢山いるとゲームが有利になります。\n\n\n## 運営が3000円で販売せざるを得ない要素","slug":"1","published":0,"updated":"2017-02-21T11:56:03.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cizfk5cnx0003thc13dcre290","content":"<p>ドレスショップ5人限定3000円ですか。いやー高いっす。</p>\n<p>ところで、この話題って二つの側面がありますよね。まず最初に、なぜガシャに財産を惜しまないユーザーが「3000円は高い」と感じるのか。不思議といえば不思議ですよね、10万に比べたら3000円なんて軽微な額ですもんね。</p>\n<p>もうひとつの側面は、なぜ運営が (ガシャチケットすらなしで) 3000円という価格設定にしたのか。これまでデレステはグラブルのグランデ (→トリコロール) とグラブルのサプチケ (→スカウトチケット) をフォローしてきたわけですから、普通に考えればグラブルのスキンを真似して「キャラ一人の固定衣装 + ガシャチケ」となりそうなものです。ところがそうなっていない。なんで今回に限ってそうじゃないのか。</p>\n<p>いちおう先に書いておきますけど以下の内容は全て妄想です。統計的根拠はないです。</p>\n<h2 id=\"なぜ「3000円は高い」のか\"><a href=\"#なぜ「3000円は高い」のか\" class=\"headerlink\" title=\"なぜ「3000円は高い」のか\"></a>なぜ「3000円は高い」のか</h2><h3 id=\"1-スカチケより安くないから、高い\"><a href=\"#1-スカチケより安くないから、高い\" class=\"headerlink\" title=\"1. スカチケより安くないから、高い\"></a>1. スカチケより安くないから、高い</h3><p>あえて指摘するまでもないような話ですが、最大の要因はやはりデレステ自身が過去2回にわたって販売した「スカウトチケット」 (3000円) でしょう。</p>\n<ul>\n<li>スカチケとは、3000円払うとガシャが回せて、そのうえ確定で好きなSSRを1枚もらえるという、射幸性の抑えられたステキな季節商品です。</li>\n<li>SSRとは、ガシャでのみ入手できる、イラストを忠実に再現した3Dモデルつきのキャラクターです。ステータス・スキルが強力なので沢山いるとゲームが有利になります。</li>\n</ul>\n<h2 id=\"運営が3000円で販売せざるを得ない要素\"><a href=\"#運営が3000円で販売せざるを得ない要素\" class=\"headerlink\" title=\"運営が3000円で販売せざるを得ない要素\"></a>運営が3000円で販売せざるを得ない要素</h2>","excerpt":"","more":"<p>ドレスショップ5人限定3000円ですか。いやー高いっす。</p>\n<p>ところで、この話題って二つの側面がありますよね。まず最初に、なぜガシャに財産を惜しまないユーザーが「3000円は高い」と感じるのか。不思議といえば不思議ですよね、10万に比べたら3000円なんて軽微な額ですもんね。</p>\n<p>もうひとつの側面は、なぜ運営が (ガシャチケットすらなしで) 3000円という価格設定にしたのか。これまでデレステはグラブルのグランデ (→トリコロール) とグラブルのサプチケ (→スカウトチケット) をフォローしてきたわけですから、普通に考えればグラブルのスキンを真似して「キャラ一人の固定衣装 + ガシャチケ」となりそうなものです。ところがそうなっていない。なんで今回に限ってそうじゃないのか。</p>\n<p>いちおう先に書いておきますけど以下の内容は全て妄想です。統計的根拠はないです。</p>\n<h2 id=\"なぜ「3000円は高い」のか\"><a href=\"#なぜ「3000円は高い」のか\" class=\"headerlink\" title=\"なぜ「3000円は高い」のか\"></a>なぜ「3000円は高い」のか</h2><h3 id=\"1-スカチケより安くないから、高い\"><a href=\"#1-スカチケより安くないから、高い\" class=\"headerlink\" title=\"1. スカチケより安くないから、高い\"></a>1. スカチケより安くないから、高い</h3><p>あえて指摘するまでもないような話ですが、最大の要因はやはりデレステ自身が過去2回にわたって販売した「スカウトチケット」 (3000円) でしょう。</p>\n<ul>\n<li>スカチケとは、3000円払うとガシャが回せて、そのうえ確定で好きなSSRを1枚もらえるという、射幸性の抑えられたステキな季節商品です。</li>\n<li>SSRとは、ガシャでのみ入手できる、イラストを忠実に再現した3Dモデルつきのキャラクターです。ステータス・スキルが強力なので沢山いるとゲームが有利になります。</li>\n</ul>\n<h2 id=\"運営が3000円で販売せざるを得ない要素\"><a href=\"#運営が3000円で販売せざるを得ない要素\" class=\"headerlink\" title=\"運営が3000円で販売せざるを得ない要素\"></a>運営が3000円で販売せざるを得ない要素</h2>"},{"title":"サイト引っ越しとかいう死語について","date":"2016-11-20T07:45:39.000Z","_content":"\n昔はよく言いましたよねえ、サイトのお引越し。この5年ほどですっかり聞かなくなった印象があります。\n\n「無償ブログサービスを渡り歩く人が減った」とか、「個人がドメインを持つのが当たり前になった」とか、「Webサイトを持つこと自体が流行らなくなった」とか、まあ色々と理由はありそうですね。知らんけど。\n\n私なんかは割と「タグ手打ちで工事中」みたいなレトロな世界に馴染みのある人間なんですけど、あの頃は大変だったですねえ… なにしろ世界中で車輪を再発名してましたもんね。今ならtwitterとfacebookでアカウント作って終わりだもん、そりゃインターネットも別世界になるよなあと。\n\nそこで僕も人類の進歩に便乗し、コマンド一発でブログ作れちゃう[Hexo](https://hexo.io/)くんのチカラを使ってみました。ただ現状サーバー料金を払う金がないので、関連するリソースはすべて[github](https://github.com/tottokotkd/tottokotkd.github.io)くんにあります。完全にタダ乗りだけど、なんか技術っぽい記事をたまに書けば許されると思います。\n\n今ぼんやり考えているのはツイッター関係で一つ、ニュース関係でもう一つ、CUIツールでさらに一つ… でもまあ多分しばらく形にならないので、やむを得ず、本当に仕方なく、どうしても嫌なんだけど不本意ながら、ただの日記みたいな記事を書きます。嗚呼残念だナ。\n\nなおHexo / github関連の記事は書かない。参考情報が沢山あるから今更追加する必要もない。","source":"_posts/20161120.md","raw":"---\ntitle: サイト引っ越しとかいう死語について\ndate: 2016-11-20 16:45:39\npermalink: 1\ntags:\n---\n\n昔はよく言いましたよねえ、サイトのお引越し。この5年ほどですっかり聞かなくなった印象があります。\n\n「無償ブログサービスを渡り歩く人が減った」とか、「個人がドメインを持つのが当たり前になった」とか、「Webサイトを持つこと自体が流行らなくなった」とか、まあ色々と理由はありそうですね。知らんけど。\n\n私なんかは割と「タグ手打ちで工事中」みたいなレトロな世界に馴染みのある人間なんですけど、あの頃は大変だったですねえ… なにしろ世界中で車輪を再発名してましたもんね。今ならtwitterとfacebookでアカウント作って終わりだもん、そりゃインターネットも別世界になるよなあと。\n\nそこで僕も人類の進歩に便乗し、コマンド一発でブログ作れちゃう[Hexo](https://hexo.io/)くんのチカラを使ってみました。ただ現状サーバー料金を払う金がないので、関連するリソースはすべて[github](https://github.com/tottokotkd/tottokotkd.github.io)くんにあります。完全にタダ乗りだけど、なんか技術っぽい記事をたまに書けば許されると思います。\n\n今ぼんやり考えているのはツイッター関係で一つ、ニュース関係でもう一つ、CUIツールでさらに一つ… でもまあ多分しばらく形にならないので、やむを得ず、本当に仕方なく、どうしても嫌なんだけど不本意ながら、ただの日記みたいな記事を書きます。嗚呼残念だナ。\n\nなおHexo / github関連の記事は書かない。参考情報が沢山あるから今更追加する必要もない。","slug":"1","published":1,"updated":"2017-02-21T11:39:42.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cizfk5cnz0004thc145c2l5my","content":"<p>昔はよく言いましたよねえ、サイトのお引越し。この5年ほどですっかり聞かなくなった印象があります。</p>\n<p>「無償ブログサービスを渡り歩く人が減った」とか、「個人がドメインを持つのが当たり前になった」とか、「Webサイトを持つこと自体が流行らなくなった」とか、まあ色々と理由はありそうですね。知らんけど。</p>\n<p>私なんかは割と「タグ手打ちで工事中」みたいなレトロな世界に馴染みのある人間なんですけど、あの頃は大変だったですねえ… なにしろ世界中で車輪を再発名してましたもんね。今ならtwitterとfacebookでアカウント作って終わりだもん、そりゃインターネットも別世界になるよなあと。</p>\n<p>そこで僕も人類の進歩に便乗し、コマンド一発でブログ作れちゃう<a href=\"https://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo</a>くんのチカラを使ってみました。ただ現状サーバー料金を払う金がないので、関連するリソースはすべて<a href=\"https://github.com/tottokotkd/tottokotkd.github.io\" target=\"_blank\" rel=\"external\">github</a>くんにあります。完全にタダ乗りだけど、なんか技術っぽい記事をたまに書けば許されると思います。</p>\n<p>今ぼんやり考えているのはツイッター関係で一つ、ニュース関係でもう一つ、CUIツールでさらに一つ… でもまあ多分しばらく形にならないので、やむを得ず、本当に仕方なく、どうしても嫌なんだけど不本意ながら、ただの日記みたいな記事を書きます。嗚呼残念だナ。</p>\n<p>なおHexo / github関連の記事は書かない。参考情報が沢山あるから今更追加する必要もない。</p>\n","excerpt":"","more":"<p>昔はよく言いましたよねえ、サイトのお引越し。この5年ほどですっかり聞かなくなった印象があります。</p>\n<p>「無償ブログサービスを渡り歩く人が減った」とか、「個人がドメインを持つのが当たり前になった」とか、「Webサイトを持つこと自体が流行らなくなった」とか、まあ色々と理由はありそうですね。知らんけど。</p>\n<p>私なんかは割と「タグ手打ちで工事中」みたいなレトロな世界に馴染みのある人間なんですけど、あの頃は大変だったですねえ… なにしろ世界中で車輪を再発名してましたもんね。今ならtwitterとfacebookでアカウント作って終わりだもん、そりゃインターネットも別世界になるよなあと。</p>\n<p>そこで僕も人類の進歩に便乗し、コマンド一発でブログ作れちゃう<a href=\"https://hexo.io/\">Hexo</a>くんのチカラを使ってみました。ただ現状サーバー料金を払う金がないので、関連するリソースはすべて<a href=\"https://github.com/tottokotkd/tottokotkd.github.io\">github</a>くんにあります。完全にタダ乗りだけど、なんか技術っぽい記事をたまに書けば許されると思います。</p>\n<p>今ぼんやり考えているのはツイッター関係で一つ、ニュース関係でもう一つ、CUIツールでさらに一つ… でもまあ多分しばらく形にならないので、やむを得ず、本当に仕方なく、どうしても嫌なんだけど不本意ながら、ただの日記みたいな記事を書きます。嗚呼残念だナ。</p>\n<p>なおHexo / github関連の記事は書かない。参考情報が沢山あるから今更追加する必要もない。</p>\n"},{"title":"Swift + Kitura + MySQLで頑張っている件","date":"2016-12-02T03:33:13.000Z","_content":"\nこのコードをコピペすればswiftでmysqlサーバー叩いてJSON垂れ流せるぞ！ (実際に試したのはMariaDBだけど)\n\nまずパッケージね。試してないけどLinuxでも動く気がする。\n\n```swift\nimport PackageDescription\n\nlet package = Package(\n    name: \"nwsns\",\n    dependencies: [\n        .Package(url: \"https://github.com/IBM-Swift/Kitura.git\", majorVersion: 1, minor: 2),\n        .Package(url: \"https://github.com/tottokotkd/MariaDbTaler.git\", majorVersion: 0, minor: 1)\n    ])\n```\n\nそしてサーバー立てる。コードは超簡単だから説明不要ですねえ。\n\n```swift\nimport Foundation\nimport Sterntaler\nimport MariaDbTaler\nimport Kitura\nimport SwiftyJSON\n\n// Create a new router\nlet router = Router()\nlet pool = MariaDB.get(host: \"127.0.0.1\", user: \"root\", password: \"pass\", database: \"fosdb\")\nlet columns = (Columns.int(\"id\"), Columns.string(\"name\"), NullableColumns.date(\"day\"))\n\n// Handle HTTP GET requests to /\nrouter.get(\"/\") { request, response, next in\n    let data = pool.execute(sql: \"SELECT id, name, day FROM test\")\n        .map{$0.read(tuple: columns)}\n        .map{[\"id\": $0.0, \"name\": $0.1, \"day\": $0.2?.description ?? \"null\"]}\n    try! response.status(.OK).send(json: JSON(data)).end()\n    next()\n}\n\n// Add an HTTP server and connect it to the router\nKitura.addHTTPServer(onPort: 8090, with: router)\n\n// Start the Kitura runloop (this call never returns)\nKitura.run()\n```\n\nSterntaler / MariaDbTalerとかいうモジュールがMySQL Connector/Cの自作ラッパーです。ホントは劣化Slickみたいなすごいやつ作りたかったけど当然無理なので妥協しました。SQLインジェクション対策すらない時点で100%ダメなのですけど、でもなんだか既存のコードもしっくり来なくて… \n\nちなみにプールとか言ってますが勿論ウソです。毎回つないでます。\n\n\nこれを動かす場合、`brew install mariadb`でMariaDBを入れて、それっぽいデータベースとテーブル作って、`swift build -Xlinker -L/usr/local/lib -Xcc -I/usr/local/include -Xswiftc -lmysqlclient`でビルドすれば動く気がします。もちろんKituraの依存ライブラリーも入れましょう。\n\nちなみに、いま世間にいくつかあるSwift系mysqlライブラリーにはOpenSSLが入っていないとビルドできないものがあるみたいです。ところがOpenSSLをbrewでインストールするとリンク段階で失敗することがあるので、その場合ビルドするときには`-Xcc -I/usr/local/opt/openssl/include -Xlinker -L/usr/local/opt/openssl/lib`とか指定するといいです。たぶん。\n\n（それらはGPLに静的リンクしているような気がするけど調べてません）\n\nこの方向で何かちょっと動くものを作れるか頑張ってます。しかし実際どうなるかはわかんない。","source":"_posts/20161202.md","raw":"---\ntitle: Swift + Kitura + MySQLで頑張っている件\ndate: 2016-12-02 12:33:13\npermalink: 1\ntags:\n- Swift\n- Kitura\n- MariaDB\n- Sterntaler\n---\n\nこのコードをコピペすればswiftでmysqlサーバー叩いてJSON垂れ流せるぞ！ (実際に試したのはMariaDBだけど)\n\nまずパッケージね。試してないけどLinuxでも動く気がする。\n\n```swift\nimport PackageDescription\n\nlet package = Package(\n    name: \"nwsns\",\n    dependencies: [\n        .Package(url: \"https://github.com/IBM-Swift/Kitura.git\", majorVersion: 1, minor: 2),\n        .Package(url: \"https://github.com/tottokotkd/MariaDbTaler.git\", majorVersion: 0, minor: 1)\n    ])\n```\n\nそしてサーバー立てる。コードは超簡単だから説明不要ですねえ。\n\n```swift\nimport Foundation\nimport Sterntaler\nimport MariaDbTaler\nimport Kitura\nimport SwiftyJSON\n\n// Create a new router\nlet router = Router()\nlet pool = MariaDB.get(host: \"127.0.0.1\", user: \"root\", password: \"pass\", database: \"fosdb\")\nlet columns = (Columns.int(\"id\"), Columns.string(\"name\"), NullableColumns.date(\"day\"))\n\n// Handle HTTP GET requests to /\nrouter.get(\"/\") { request, response, next in\n    let data = pool.execute(sql: \"SELECT id, name, day FROM test\")\n        .map{$0.read(tuple: columns)}\n        .map{[\"id\": $0.0, \"name\": $0.1, \"day\": $0.2?.description ?? \"null\"]}\n    try! response.status(.OK).send(json: JSON(data)).end()\n    next()\n}\n\n// Add an HTTP server and connect it to the router\nKitura.addHTTPServer(onPort: 8090, with: router)\n\n// Start the Kitura runloop (this call never returns)\nKitura.run()\n```\n\nSterntaler / MariaDbTalerとかいうモジュールがMySQL Connector/Cの自作ラッパーです。ホントは劣化Slickみたいなすごいやつ作りたかったけど当然無理なので妥協しました。SQLインジェクション対策すらない時点で100%ダメなのですけど、でもなんだか既存のコードもしっくり来なくて… \n\nちなみにプールとか言ってますが勿論ウソです。毎回つないでます。\n\n\nこれを動かす場合、`brew install mariadb`でMariaDBを入れて、それっぽいデータベースとテーブル作って、`swift build -Xlinker -L/usr/local/lib -Xcc -I/usr/local/include -Xswiftc -lmysqlclient`でビルドすれば動く気がします。もちろんKituraの依存ライブラリーも入れましょう。\n\nちなみに、いま世間にいくつかあるSwift系mysqlライブラリーにはOpenSSLが入っていないとビルドできないものがあるみたいです。ところがOpenSSLをbrewでインストールするとリンク段階で失敗することがあるので、その場合ビルドするときには`-Xcc -I/usr/local/opt/openssl/include -Xlinker -L/usr/local/opt/openssl/lib`とか指定するといいです。たぶん。\n\n（それらはGPLに静的リンクしているような気がするけど調べてません）\n\nこの方向で何かちょっと動くものを作れるか頑張ってます。しかし実際どうなるかはわかんない。","slug":"1","published":1,"updated":"2017-02-21T11:56:03.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cizfk5co10005thc1i1ag1ttg","content":"<p>このコードをコピペすればswiftでmysqlサーバー叩いてJSON垂れ流せるぞ！ (実際に試したのはMariaDBだけど)</p>\n<p>まずパッケージね。試してないけどLinuxでも動く気がする。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> PackageDescription</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> package = <span class=\"type\">Package</span>(</div><div class=\"line\">    name: <span class=\"string\">\"nwsns\"</span>,</div><div class=\"line\">    dependencies: [</div><div class=\"line\">        .<span class=\"type\">Package</span>(url: <span class=\"string\">\"https://github.com/IBM-Swift/Kitura.git\"</span>, majorVersion: <span class=\"number\">1</span>, minor: <span class=\"number\">2</span>),</div><div class=\"line\">        .<span class=\"type\">Package</span>(url: <span class=\"string\">\"https://github.com/tottokotkd/MariaDbTaler.git\"</span>, majorVersion: <span class=\"number\">0</span>, minor: <span class=\"number\">1</span>)</div><div class=\"line\">    ])</div></pre></td></tr></table></figure>\n<p>そしてサーバー立てる。コードは超簡単だから説明不要ですねえ。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> Foundation</div><div class=\"line\"><span class=\"keyword\">import</span> Sterntaler</div><div class=\"line\"><span class=\"keyword\">import</span> MariaDbTaler</div><div class=\"line\"><span class=\"keyword\">import</span> Kitura</div><div class=\"line\"><span class=\"keyword\">import</span> SwiftyJSON</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Create a new router</span></div><div class=\"line\"><span class=\"keyword\">let</span> router = <span class=\"type\">Router</span>()</div><div class=\"line\"><span class=\"keyword\">let</span> pool = <span class=\"type\">MariaDB</span>.<span class=\"keyword\">get</span>(host: <span class=\"string\">\"127.0.0.1\"</span>, user: <span class=\"string\">\"root\"</span>, password: <span class=\"string\">\"pass\"</span>, database: <span class=\"string\">\"fosdb\"</span>)</div><div class=\"line\"><span class=\"keyword\">let</span> columns = (<span class=\"type\">Columns</span>.int(<span class=\"string\">\"id\"</span>), <span class=\"type\">Columns</span>.string(<span class=\"string\">\"name\"</span>), <span class=\"type\">NullableColumns</span>.date(<span class=\"string\">\"day\"</span>))</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Handle HTTP GET requests to /</span></div><div class=\"line\">router.<span class=\"keyword\">get</span>(<span class=\"string\">\"/\"</span>) &#123; request, response, next <span class=\"keyword\">in</span></div><div class=\"line\">    <span class=\"keyword\">let</span> data = pool.execute(sql: <span class=\"string\">\"SELECT id, name, day FROM test\"</span>)</div><div class=\"line\">        .<span class=\"built_in\">map</span>&#123;$<span class=\"number\">0</span>.read(tuple: columns)&#125;</div><div class=\"line\">        .<span class=\"built_in\">map</span>&#123;[<span class=\"string\">\"id\"</span>: $<span class=\"number\">0.0</span>, <span class=\"string\">\"name\"</span>: $<span class=\"number\">0.1</span>, <span class=\"string\">\"day\"</span>: $<span class=\"number\">0.2</span>?.description ?? <span class=\"string\">\"null\"</span>]&#125;</div><div class=\"line\">    <span class=\"keyword\">try</span>! response.status(.<span class=\"type\">OK</span>).send(json: <span class=\"type\">JSON</span>(data)).end()</div><div class=\"line\">    next()</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Add an HTTP server and connect it to the router</span></div><div class=\"line\"><span class=\"type\">Kitura</span>.addHTTPServer(onPort: <span class=\"number\">8090</span>, with: router)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Start the Kitura runloop (this call never returns)</span></div><div class=\"line\"><span class=\"type\">Kitura</span>.run()</div></pre></td></tr></table></figure>\n<p>Sterntaler / MariaDbTalerとかいうモジュールがMySQL Connector/Cの自作ラッパーです。ホントは劣化Slickみたいなすごいやつ作りたかったけど当然無理なので妥協しました。SQLインジェクション対策すらない時点で100%ダメなのですけど、でもなんだか既存のコードもしっくり来なくて… </p>\n<p>ちなみにプールとか言ってますが勿論ウソです。毎回つないでます。</p>\n<p>これを動かす場合、<code>brew install mariadb</code>でMariaDBを入れて、それっぽいデータベースとテーブル作って、<code>swift build -Xlinker -L/usr/local/lib -Xcc -I/usr/local/include -Xswiftc -lmysqlclient</code>でビルドすれば動く気がします。もちろんKituraの依存ライブラリーも入れましょう。</p>\n<p>ちなみに、いま世間にいくつかあるSwift系mysqlライブラリーにはOpenSSLが入っていないとビルドできないものがあるみたいです。ところがOpenSSLをbrewでインストールするとリンク段階で失敗することがあるので、その場合ビルドするときには<code>-Xcc -I/usr/local/opt/openssl/include -Xlinker -L/usr/local/opt/openssl/lib</code>とか指定するといいです。たぶん。</p>\n<p>（それらはGPLに静的リンクしているような気がするけど調べてません）</p>\n<p>この方向で何かちょっと動くものを作れるか頑張ってます。しかし実際どうなるかはわかんない。</p>\n","excerpt":"","more":"<p>このコードをコピペすればswiftでmysqlサーバー叩いてJSON垂れ流せるぞ！ (実際に試したのはMariaDBだけど)</p>\n<p>まずパッケージね。試してないけどLinuxでも動く気がする。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> PackageDescription</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">let</span> package = <span class=\"type\">Package</span>(</div><div class=\"line\">    name: <span class=\"string\">\"nwsns\"</span>,</div><div class=\"line\">    dependencies: [</div><div class=\"line\">        .<span class=\"type\">Package</span>(url: <span class=\"string\">\"https://github.com/IBM-Swift/Kitura.git\"</span>, majorVersion: <span class=\"number\">1</span>, minor: <span class=\"number\">2</span>),</div><div class=\"line\">        .<span class=\"type\">Package</span>(url: <span class=\"string\">\"https://github.com/tottokotkd/MariaDbTaler.git\"</span>, majorVersion: <span class=\"number\">0</span>, minor: <span class=\"number\">1</span>)</div><div class=\"line\">    ])</div></pre></td></tr></table></figure>\n<p>そしてサーバー立てる。コードは超簡単だから説明不要ですねえ。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> Foundation</div><div class=\"line\"><span class=\"keyword\">import</span> Sterntaler</div><div class=\"line\"><span class=\"keyword\">import</span> MariaDbTaler</div><div class=\"line\"><span class=\"keyword\">import</span> Kitura</div><div class=\"line\"><span class=\"keyword\">import</span> SwiftyJSON</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Create a new router</span></div><div class=\"line\"><span class=\"keyword\">let</span> router = <span class=\"type\">Router</span>()</div><div class=\"line\"><span class=\"keyword\">let</span> pool = <span class=\"type\">MariaDB</span>.<span class=\"keyword\">get</span>(host: <span class=\"string\">\"127.0.0.1\"</span>, user: <span class=\"string\">\"root\"</span>, password: <span class=\"string\">\"pass\"</span>, database: <span class=\"string\">\"fosdb\"</span>)</div><div class=\"line\"><span class=\"keyword\">let</span> columns = (<span class=\"type\">Columns</span>.int(<span class=\"string\">\"id\"</span>), <span class=\"type\">Columns</span>.string(<span class=\"string\">\"name\"</span>), <span class=\"type\">NullableColumns</span>.date(<span class=\"string\">\"day\"</span>))</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Handle HTTP GET requests to /</span></div><div class=\"line\">router.<span class=\"keyword\">get</span>(<span class=\"string\">\"/\"</span>) &#123; request, response, next <span class=\"keyword\">in</span></div><div class=\"line\">    <span class=\"keyword\">let</span> data = pool.execute(sql: <span class=\"string\">\"SELECT id, name, day FROM test\"</span>)</div><div class=\"line\">        .<span class=\"built_in\">map</span>&#123;$<span class=\"number\">0</span>.read(tuple: columns)&#125;</div><div class=\"line\">        .<span class=\"built_in\">map</span>&#123;[<span class=\"string\">\"id\"</span>: $<span class=\"number\">0.0</span>, <span class=\"string\">\"name\"</span>: $<span class=\"number\">0.1</span>, <span class=\"string\">\"day\"</span>: $<span class=\"number\">0.2</span>?.description ?? <span class=\"string\">\"null\"</span>]&#125;</div><div class=\"line\">    <span class=\"keyword\">try</span>! response.status(.<span class=\"type\">OK</span>).send(json: <span class=\"type\">JSON</span>(data)).end()</div><div class=\"line\">    next()</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Add an HTTP server and connect it to the router</span></div><div class=\"line\"><span class=\"type\">Kitura</span>.addHTTPServer(onPort: <span class=\"number\">8090</span>, with: router)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// Start the Kitura runloop (this call never returns)</span></div><div class=\"line\"><span class=\"type\">Kitura</span>.run()</div></pre></td></tr></table></figure>\n<p>Sterntaler / MariaDbTalerとかいうモジュールがMySQL Connector/Cの自作ラッパーです。ホントは劣化Slickみたいなすごいやつ作りたかったけど当然無理なので妥協しました。SQLインジェクション対策すらない時点で100%ダメなのですけど、でもなんだか既存のコードもしっくり来なくて… </p>\n<p>ちなみにプールとか言ってますが勿論ウソです。毎回つないでます。</p>\n<p>これを動かす場合、<code>brew install mariadb</code>でMariaDBを入れて、それっぽいデータベースとテーブル作って、<code>swift build -Xlinker -L/usr/local/lib -Xcc -I/usr/local/include -Xswiftc -lmysqlclient</code>でビルドすれば動く気がします。もちろんKituraの依存ライブラリーも入れましょう。</p>\n<p>ちなみに、いま世間にいくつかあるSwift系mysqlライブラリーにはOpenSSLが入っていないとビルドできないものがあるみたいです。ところがOpenSSLをbrewでインストールするとリンク段階で失敗することがあるので、その場合ビルドするときには<code>-Xcc -I/usr/local/opt/openssl/include -Xlinker -L/usr/local/opt/openssl/lib</code>とか指定するといいです。たぶん。</p>\n<p>（それらはGPLに静的リンクしているような気がするけど調べてません）</p>\n<p>この方向で何かちょっと動くものを作れるか頑張ってます。しかし実際どうなるかはわかんない。</p>\n"},{"title":"swift buildで渡すオプションをいちいち書きたくないのでcmakeする","date":"2016-11-22T13:33:03.000Z","_content":"\nいまサーバーサイドSwiftが盛り上がっています。まだ派手に燃えてはいませんが、確実に火がついています。だいたいXamarin勉強会の翌日くらい燃えてます。\n\nそういう次第でswiftの話です。毎度毎度 `swift build -Xswiftc -I/usr/local/include/mysql -Xlinker -L/usr/local/lib\n` とか書きたくない人は幸せになれるかもしれないです。\n\n## CMakeFiles.txtを書くべし\n\nまずこういうやつ書いてください。ビルドコマンドのオプションを適宜いい感じにしましょう。\n\n```cmake\ncmake_minimum_required(VERSION 3.6)\nproject(MariaDbTaler)\n\nset(SOURCE_FILES\n        Sources/MariaDbDriver.swift\n        Package.swift)\n\nset(SWIFT_COMMAND\n        swift build\n        -Xlinker -L/usr/local/lib\n        -Xcc -I/usr/local/include\n        -Xswiftc -lmysqlclient)\n\nadd_custom_target(MariaDbTaler\n        COMMAND ${SWIFT_COMMAND}\n        WORKING_DIRECTORY ${CMAKE_SOURCE_DIR}\n        SOURCES ${SOURCE_FILES})\n```\n\nなお試してませんが明らかに`SOURCE_FILES`は書かなくてよい気がいたします。\n\n## `cmake .`すべし\n\n[人類なら`out-of-source`ビルドしなさい](http://qiita.com/osamu0329/items/7de2b190df3cfb4ad0ca)という話もありますが、最初はまあいいです。1回実行してゴミファイルが大量に出来てから後悔しても遅くないです。\n\n## `make XXXXXX` すべし\n\n上の例だと`make MariaDbTaler`ですね。プロジェクト名を渡してやります。そうするとあらかじめ設定してあるコマンドが走るのです。\n\n## 別にCMakeいらなくね？\n\nいらないです。CMake経由しても特にいいことないしシェルスクリプト書けばいいじゃん。なんだよこれ！\n\nところが、みんな大好きJetBrains謹製IDEであるCLionくんが \"[CLion relies on CMake project model, so you need to start a CMake project for Swift](https://blog.jetbrains.com/clion/2015/12/swift-plugin-for-clion/)\" と宣うているのです。正直まだまだCLionのSwiftプラグインはショボくて辛い感じなのですが、CLionを使うならCMakeFiles.txtは嫌でも書かなきゃいけません。そこで一括して書けると考えれば、まあちょっとだけ便利です。\n\n## 余談: -Xswiftc is 何\n\n`swift --help`ってなんか使いにくい気がしてならないんですよね。ヘルプ叩いたらサブコマンドの一覧も出してほしいし… `swift package update`の存在とか分かりにくすぎるし… しかしまあそれはいいです。\n\n`-Xswiftc`のことは`swift build --help`すれば分かります。\n\n```swift\n$ swift build --help\n\nOVERVIEW: Build sources into binary products\n\nUSAGE: swift build [mode] [options]\n\nMODES:\n  -c, --configuration <value>   Build with configuration (debug|release) [default: debug]\n  --clean [<mode>]              Delete artifacts (build|dist) [default: build]\n\nOPTIONS:\n  -C, --chdir <path>       Change working directory before any other operation\n  --build-path <path>      Specify build/cache directory [default: ./.build]\n  --color <mode>           Specify color mode (auto|always|never) [default: auto]\n  -v, --verbose            Increase verbosity of informational output\n  -Xcc <flag>              Pass flag through to all C compiler invocations\n  -Xlinker <flag>          Pass flag through to all linker invocations\n  -Xswiftc <flag>          Pass flag through to all Swift compiler invocations\n\nNOTE: Use `swift package` to perform other functions on packages\n```\n\n`-Xswiftc`は分かったけど`-I/usr/local/include/mysql`が分からないんですけど！という人がいると困るので`swift --help | grep -e -I`します(全文は長い)。\n\n```swift\n$ swift --help | grep -e -I\n\n  -I <value>             Add directory to the import search path\n```\n\ngccでよく見かける愉快な仲間たちですね。Xcodeを使っていると普段全く意識しないと思いますが、-Iは「ヘッダーファイルをどこで探すか」を指定するオプションです。Xcodeのビルド設定にも`header search paths`とかいう項目がありますよね。アレですアレ。\n\nこれはつまり古代C言語の領域に突入しているわけです。`swift build`の挙動がよく分からないという人はC++あたりのコンパイラ・リンカの解説記事を読むといいかもしれないです。\n\n決してコンパイラーではありません、コンパイラです。","source":"_posts/20161122.md","raw":"---\ntitle: swift buildで渡すオプションをいちいち書きたくないのでcmakeする\ndate: 2016-11-22 22:33:03\npermalink: 1\ntags:\n - Swift\n - CLion\n - CMake\n---\n\nいまサーバーサイドSwiftが盛り上がっています。まだ派手に燃えてはいませんが、確実に火がついています。だいたいXamarin勉強会の翌日くらい燃えてます。\n\nそういう次第でswiftの話です。毎度毎度 `swift build -Xswiftc -I/usr/local/include/mysql -Xlinker -L/usr/local/lib\n` とか書きたくない人は幸せになれるかもしれないです。\n\n## CMakeFiles.txtを書くべし\n\nまずこういうやつ書いてください。ビルドコマンドのオプションを適宜いい感じにしましょう。\n\n```cmake\ncmake_minimum_required(VERSION 3.6)\nproject(MariaDbTaler)\n\nset(SOURCE_FILES\n        Sources/MariaDbDriver.swift\n        Package.swift)\n\nset(SWIFT_COMMAND\n        swift build\n        -Xlinker -L/usr/local/lib\n        -Xcc -I/usr/local/include\n        -Xswiftc -lmysqlclient)\n\nadd_custom_target(MariaDbTaler\n        COMMAND ${SWIFT_COMMAND}\n        WORKING_DIRECTORY ${CMAKE_SOURCE_DIR}\n        SOURCES ${SOURCE_FILES})\n```\n\nなお試してませんが明らかに`SOURCE_FILES`は書かなくてよい気がいたします。\n\n## `cmake .`すべし\n\n[人類なら`out-of-source`ビルドしなさい](http://qiita.com/osamu0329/items/7de2b190df3cfb4ad0ca)という話もありますが、最初はまあいいです。1回実行してゴミファイルが大量に出来てから後悔しても遅くないです。\n\n## `make XXXXXX` すべし\n\n上の例だと`make MariaDbTaler`ですね。プロジェクト名を渡してやります。そうするとあらかじめ設定してあるコマンドが走るのです。\n\n## 別にCMakeいらなくね？\n\nいらないです。CMake経由しても特にいいことないしシェルスクリプト書けばいいじゃん。なんだよこれ！\n\nところが、みんな大好きJetBrains謹製IDEであるCLionくんが \"[CLion relies on CMake project model, so you need to start a CMake project for Swift](https://blog.jetbrains.com/clion/2015/12/swift-plugin-for-clion/)\" と宣うているのです。正直まだまだCLionのSwiftプラグインはショボくて辛い感じなのですが、CLionを使うならCMakeFiles.txtは嫌でも書かなきゃいけません。そこで一括して書けると考えれば、まあちょっとだけ便利です。\n\n## 余談: -Xswiftc is 何\n\n`swift --help`ってなんか使いにくい気がしてならないんですよね。ヘルプ叩いたらサブコマンドの一覧も出してほしいし… `swift package update`の存在とか分かりにくすぎるし… しかしまあそれはいいです。\n\n`-Xswiftc`のことは`swift build --help`すれば分かります。\n\n```swift\n$ swift build --help\n\nOVERVIEW: Build sources into binary products\n\nUSAGE: swift build [mode] [options]\n\nMODES:\n  -c, --configuration <value>   Build with configuration (debug|release) [default: debug]\n  --clean [<mode>]              Delete artifacts (build|dist) [default: build]\n\nOPTIONS:\n  -C, --chdir <path>       Change working directory before any other operation\n  --build-path <path>      Specify build/cache directory [default: ./.build]\n  --color <mode>           Specify color mode (auto|always|never) [default: auto]\n  -v, --verbose            Increase verbosity of informational output\n  -Xcc <flag>              Pass flag through to all C compiler invocations\n  -Xlinker <flag>          Pass flag through to all linker invocations\n  -Xswiftc <flag>          Pass flag through to all Swift compiler invocations\n\nNOTE: Use `swift package` to perform other functions on packages\n```\n\n`-Xswiftc`は分かったけど`-I/usr/local/include/mysql`が分からないんですけど！という人がいると困るので`swift --help | grep -e -I`します(全文は長い)。\n\n```swift\n$ swift --help | grep -e -I\n\n  -I <value>             Add directory to the import search path\n```\n\ngccでよく見かける愉快な仲間たちですね。Xcodeを使っていると普段全く意識しないと思いますが、-Iは「ヘッダーファイルをどこで探すか」を指定するオプションです。Xcodeのビルド設定にも`header search paths`とかいう項目がありますよね。アレですアレ。\n\nこれはつまり古代C言語の領域に突入しているわけです。`swift build`の挙動がよく分からないという人はC++あたりのコンパイラ・リンカの解説記事を読むといいかもしれないです。\n\n決してコンパイラーではありません、コンパイラです。","slug":"1","published":1,"updated":"2017-02-21T11:56:03.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cizfk5co30007thc1iuz2hh3m","content":"<p>いまサーバーサイドSwiftが盛り上がっています。まだ派手に燃えてはいませんが、確実に火がついています。だいたいXamarin勉強会の翌日くらい燃えてます。</p>\n<p>そういう次第でswiftの話です。毎度毎度 <code>swift build -Xswiftc -I/usr/local/include/mysql -Xlinker -L/usr/local/lib</code> とか書きたくない人は幸せになれるかもしれないです。</p>\n<h2 id=\"CMakeFiles-txtを書くべし\"><a href=\"#CMakeFiles-txtを書くべし\" class=\"headerlink\" title=\"CMakeFiles.txtを書くべし\"></a>CMakeFiles.txtを書くべし</h2><p>まずこういうやつ書いてください。ビルドコマンドのオプションを適宜いい感じにしましょう。</p>\n<figure class=\"highlight cmake\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">cmake_minimum_required</span>(VERSION <span class=\"number\">3.6</span>)</div><div class=\"line\"><span class=\"keyword\">project</span>(MariaDbTaler)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span>(SOURCE_FILES</div><div class=\"line\">        Sources/MariaDbDriver.swift</div><div class=\"line\">        Package.swift)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span>(SWIFT_COMMAND</div><div class=\"line\">        swift build</div><div class=\"line\">        -Xlinker -L/usr/local/lib</div><div class=\"line\">        -Xcc -I/usr/local/<span class=\"keyword\">include</span></div><div class=\"line\">        -Xswiftc -lmysqlclient)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">add_custom_target</span>(MariaDbTaler</div><div class=\"line\">        COMMAND <span class=\"variable\">$&#123;SWIFT_COMMAND&#125;</span></div><div class=\"line\">        WORKING_DIRECTORY <span class=\"variable\">$&#123;CMAKE_SOURCE_DIR&#125;</span></div><div class=\"line\">        SOURCES <span class=\"variable\">$&#123;SOURCE_FILES&#125;</span>)</div></pre></td></tr></table></figure>\n<p>なお試してませんが明らかに<code>SOURCE_FILES</code>は書かなくてよい気がいたします。</p>\n<h2 id=\"cmake-すべし\"><a href=\"#cmake-すべし\" class=\"headerlink\" title=\"cmake .すべし\"></a><code>cmake .</code>すべし</h2><p><a href=\"http://qiita.com/osamu0329/items/7de2b190df3cfb4ad0ca\" target=\"_blank\" rel=\"external\">人類なら<code>out-of-source</code>ビルドしなさい</a>という話もありますが、最初はまあいいです。1回実行してゴミファイルが大量に出来てから後悔しても遅くないです。</p>\n<h2 id=\"make-XXXXXX-すべし\"><a href=\"#make-XXXXXX-すべし\" class=\"headerlink\" title=\"make XXXXXX すべし\"></a><code>make XXXXXX</code> すべし</h2><p>上の例だと<code>make MariaDbTaler</code>ですね。プロジェクト名を渡してやります。そうするとあらかじめ設定してあるコマンドが走るのです。</p>\n<h2 id=\"別にCMakeいらなくね？\"><a href=\"#別にCMakeいらなくね？\" class=\"headerlink\" title=\"別にCMakeいらなくね？\"></a>別にCMakeいらなくね？</h2><p>いらないです。CMake経由しても特にいいことないしシェルスクリプト書けばいいじゃん。なんだよこれ！</p>\n<p>ところが、みんな大好きJetBrains謹製IDEであるCLionくんが “<a href=\"https://blog.jetbrains.com/clion/2015/12/swift-plugin-for-clion/\" target=\"_blank\" rel=\"external\">CLion relies on CMake project model, so you need to start a CMake project for Swift</a>“ と宣うているのです。正直まだまだCLionのSwiftプラグインはショボくて辛い感じなのですが、CLionを使うならCMakeFiles.txtは嫌でも書かなきゃいけません。そこで一括して書けると考えれば、まあちょっとだけ便利です。</p>\n<h2 id=\"余談-Xswiftc-is-何\"><a href=\"#余談-Xswiftc-is-何\" class=\"headerlink\" title=\"余談: -Xswiftc is 何\"></a>余談: -Xswiftc is 何</h2><p><code>swift --help</code>ってなんか使いにくい気がしてならないんですよね。ヘルプ叩いたらサブコマンドの一覧も出してほしいし… <code>swift package update</code>の存在とか分かりにくすぎるし… しかしまあそれはいいです。</p>\n<p><code>-Xswiftc</code>のことは<code>swift build --help</code>すれば分かります。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ swift build --help</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">OVERVIEW</span>: <span class=\"type\">Build</span> sources into binary products</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">USAGE</span>: swift build [mode] [options]</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">MODES</span>:</div><div class=\"line\">  -<span class=\"built_in\">c</span>, --configuration &lt;value&gt;   <span class=\"type\">Build</span> with configuration (debug|release) [<span class=\"keyword\">default</span>: debug]</div><div class=\"line\">  --clean [&lt;mode&gt;]              <span class=\"type\">Delete</span> artifacts (build|dist) [<span class=\"keyword\">default</span>: build]</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">OPTIONS</span>:</div><div class=\"line\">  -<span class=\"type\">C</span>, --chdir &lt;path&gt;       <span class=\"type\">Change</span> working directory before any other operation</div><div class=\"line\">  --build-path &lt;path&gt;      <span class=\"type\">Specify</span> build/cache directory [<span class=\"keyword\">default</span>: ./.build]</div><div class=\"line\">  --color &lt;mode&gt;           <span class=\"type\">Specify</span> color mode (auto|always|never) [<span class=\"keyword\">default</span>: auto]</div><div class=\"line\">  -v, --verbose            <span class=\"type\">Increase</span> verbosity of informational output</div><div class=\"line\">  -<span class=\"type\">Xcc</span> &lt;flag&gt;              <span class=\"type\">Pass</span> flag through to all <span class=\"type\">C</span> compiler invocations</div><div class=\"line\">  -<span class=\"type\">Xlinker</span> &lt;flag&gt;          <span class=\"type\">Pass</span> flag through to all linker invocations</div><div class=\"line\">  -<span class=\"type\">Xswiftc</span> &lt;flag&gt;          <span class=\"type\">Pass</span> flag through to all <span class=\"type\">Swift</span> compiler invocations</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">NOTE</span>: <span class=\"type\">Use</span> `swift package` to perform other functions on packages</div></pre></td></tr></table></figure>\n<p><code>-Xswiftc</code>は分かったけど<code>-I/usr/local/include/mysql</code>が分からないんですけど！という人がいると困るので<code>swift --help | grep -e -I</code>します(全文は長い)。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ swift --help | grep -e -<span class=\"type\">I</span></div><div class=\"line\"></div><div class=\"line\">  -<span class=\"type\">I</span> &lt;value&gt;             <span class=\"type\">Add</span> directory to the <span class=\"keyword\">import</span> search path</div></pre></td></tr></table></figure>\n<p>gccでよく見かける愉快な仲間たちですね。Xcodeを使っていると普段全く意識しないと思いますが、-Iは「ヘッダーファイルをどこで探すか」を指定するオプションです。Xcodeのビルド設定にも<code>header search paths</code>とかいう項目がありますよね。アレですアレ。</p>\n<p>これはつまり古代C言語の領域に突入しているわけです。<code>swift build</code>の挙動がよく分からないという人はC++あたりのコンパイラ・リンカの解説記事を読むといいかもしれないです。</p>\n<p>決してコンパイラーではありません、コンパイラです。</p>\n","excerpt":"","more":"<p>いまサーバーサイドSwiftが盛り上がっています。まだ派手に燃えてはいませんが、確実に火がついています。だいたいXamarin勉強会の翌日くらい燃えてます。</p>\n<p>そういう次第でswiftの話です。毎度毎度 <code>swift build -Xswiftc -I/usr/local/include/mysql -Xlinker -L/usr/local/lib</code> とか書きたくない人は幸せになれるかもしれないです。</p>\n<h2 id=\"CMakeFiles-txtを書くべし\"><a href=\"#CMakeFiles-txtを書くべし\" class=\"headerlink\" title=\"CMakeFiles.txtを書くべし\"></a>CMakeFiles.txtを書くべし</h2><p>まずこういうやつ書いてください。ビルドコマンドのオプションを適宜いい感じにしましょう。</p>\n<figure class=\"highlight cmake\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">cmake_minimum_required</span>(VERSION <span class=\"number\">3.6</span>)</div><div class=\"line\"><span class=\"keyword\">project</span>(MariaDbTaler)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span>(SOURCE_FILES</div><div class=\"line\">        Sources/MariaDbDriver.swift</div><div class=\"line\">        Package.swift)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span>(SWIFT_COMMAND</div><div class=\"line\">        swift build</div><div class=\"line\">        -Xlinker -L/usr/local/lib</div><div class=\"line\">        -Xcc -I/usr/local/<span class=\"keyword\">include</span></div><div class=\"line\">        -Xswiftc -lmysqlclient)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">add_custom_target</span>(MariaDbTaler</div><div class=\"line\">        COMMAND <span class=\"variable\">$&#123;SWIFT_COMMAND&#125;</span></div><div class=\"line\">        WORKING_DIRECTORY <span class=\"variable\">$&#123;CMAKE_SOURCE_DIR&#125;</span></div><div class=\"line\">        SOURCES <span class=\"variable\">$&#123;SOURCE_FILES&#125;</span>)</div></pre></td></tr></table></figure>\n<p>なお試してませんが明らかに<code>SOURCE_FILES</code>は書かなくてよい気がいたします。</p>\n<h2 id=\"cmake-すべし\"><a href=\"#cmake-すべし\" class=\"headerlink\" title=\"cmake .すべし\"></a><code>cmake .</code>すべし</h2><p><a href=\"http://qiita.com/osamu0329/items/7de2b190df3cfb4ad0ca\">人類なら<code>out-of-source</code>ビルドしなさい</a>という話もありますが、最初はまあいいです。1回実行してゴミファイルが大量に出来てから後悔しても遅くないです。</p>\n<h2 id=\"make-XXXXXX-すべし\"><a href=\"#make-XXXXXX-すべし\" class=\"headerlink\" title=\"make XXXXXX すべし\"></a><code>make XXXXXX</code> すべし</h2><p>上の例だと<code>make MariaDbTaler</code>ですね。プロジェクト名を渡してやります。そうするとあらかじめ設定してあるコマンドが走るのです。</p>\n<h2 id=\"別にCMakeいらなくね？\"><a href=\"#別にCMakeいらなくね？\" class=\"headerlink\" title=\"別にCMakeいらなくね？\"></a>別にCMakeいらなくね？</h2><p>いらないです。CMake経由しても特にいいことないしシェルスクリプト書けばいいじゃん。なんだよこれ！</p>\n<p>ところが、みんな大好きJetBrains謹製IDEであるCLionくんが “<a href=\"https://blog.jetbrains.com/clion/2015/12/swift-plugin-for-clion/\">CLion relies on CMake project model, so you need to start a CMake project for Swift</a>“ と宣うているのです。正直まだまだCLionのSwiftプラグインはショボくて辛い感じなのですが、CLionを使うならCMakeFiles.txtは嫌でも書かなきゃいけません。そこで一括して書けると考えれば、まあちょっとだけ便利です。</p>\n<h2 id=\"余談-Xswiftc-is-何\"><a href=\"#余談-Xswiftc-is-何\" class=\"headerlink\" title=\"余談: -Xswiftc is 何\"></a>余談: -Xswiftc is 何</h2><p><code>swift --help</code>ってなんか使いにくい気がしてならないんですよね。ヘルプ叩いたらサブコマンドの一覧も出してほしいし… <code>swift package update</code>の存在とか分かりにくすぎるし… しかしまあそれはいいです。</p>\n<p><code>-Xswiftc</code>のことは<code>swift build --help</code>すれば分かります。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ swift build --help</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">OVERVIEW</span>: <span class=\"type\">Build</span> sources into binary products</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">USAGE</span>: swift build [mode] [options]</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">MODES</span>:</div><div class=\"line\">  -<span class=\"built_in\">c</span>, --configuration &lt;value&gt;   <span class=\"type\">Build</span> with configuration (debug|release) [<span class=\"keyword\">default</span>: debug]</div><div class=\"line\">  --clean [&lt;mode&gt;]              <span class=\"type\">Delete</span> artifacts (build|dist) [<span class=\"keyword\">default</span>: build]</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">OPTIONS</span>:</div><div class=\"line\">  -<span class=\"type\">C</span>, --chdir &lt;path&gt;       <span class=\"type\">Change</span> working directory before any other operation</div><div class=\"line\">  --build-path &lt;path&gt;      <span class=\"type\">Specify</span> build/cache directory [<span class=\"keyword\">default</span>: ./.build]</div><div class=\"line\">  --color &lt;mode&gt;           <span class=\"type\">Specify</span> color mode (auto|always|never) [<span class=\"keyword\">default</span>: auto]</div><div class=\"line\">  -v, --verbose            <span class=\"type\">Increase</span> verbosity of informational output</div><div class=\"line\">  -<span class=\"type\">Xcc</span> &lt;flag&gt;              <span class=\"type\">Pass</span> flag through to all <span class=\"type\">C</span> compiler invocations</div><div class=\"line\">  -<span class=\"type\">Xlinker</span> &lt;flag&gt;          <span class=\"type\">Pass</span> flag through to all linker invocations</div><div class=\"line\">  -<span class=\"type\">Xswiftc</span> &lt;flag&gt;          <span class=\"type\">Pass</span> flag through to all <span class=\"type\">Swift</span> compiler invocations</div><div class=\"line\"></div><div class=\"line\"><span class=\"type\">NOTE</span>: <span class=\"type\">Use</span> `swift package` to perform other functions on packages</div></pre></td></tr></table></figure>\n<p><code>-Xswiftc</code>は分かったけど<code>-I/usr/local/include/mysql</code>が分からないんですけど！という人がいると困るので<code>swift --help | grep -e -I</code>します(全文は長い)。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ swift --help | grep -e -<span class=\"type\">I</span></div><div class=\"line\"></div><div class=\"line\">  -<span class=\"type\">I</span> &lt;value&gt;             <span class=\"type\">Add</span> directory to the <span class=\"keyword\">import</span> search path</div></pre></td></tr></table></figure>\n<p>gccでよく見かける愉快な仲間たちですね。Xcodeを使っていると普段全く意識しないと思いますが、-Iは「ヘッダーファイルをどこで探すか」を指定するオプションです。Xcodeのビルド設定にも<code>header search paths</code>とかいう項目がありますよね。アレですアレ。</p>\n<p>これはつまり古代C言語の領域に突入しているわけです。<code>swift build</code>の挙動がよく分からないという人はC++あたりのコンパイラ・リンカの解説記事を読むといいかもしれないです。</p>\n<p>決してコンパイラーではありません、コンパイラです。</p>\n"},{"title":"Kotlin + AWS Lambda + API GatewayでServerlessできちゃうラッパー公開したのでDynamoDBとか使っちゃう","date":"2016-12-11T03:36:08.000Z","_content":"\nタイトルの通りです。[githubに置いてある](https://github.com/tottokotkd/GatewayHandler)し、[Bintray経由でjcenterにもある](https://bintray.com/bintray/jcenter?filterByPkgName=GatewayHandler)ので使えます。この公開ルートは今回初めてやってみましたが、なかなか便利ですね。\n\nもちろん公開するだけならgithubページでもイケるんですけど、その作業が手間だったり、IntelliJくんがキャッシュ持つ段階でエラー吐いたり、面倒なのでBintrayです。今はあんまりそこを頑張りたくなかった、仕方なかった。\n\ngithubの方に書いてあるんですけど、コードでいうとこんな感じ。\n\n```kotlin\npackage hello\n\nimport com.amazonaws.regions.Regions\nimport com.amazonaws.services.dynamodbv2.document.DynamoDB\nimport com.amazonaws.services.dynamodbv2.document.Item\nimport com.amazonaws.services.lambda.runtime.Context\nimport com.tottokotkd.aws.gateway.core.*\nimport java.time.ZonedDateTime\nimport java.time.format.DateTimeFormatter\nimport kotlin.properties.Delegates\n\nclass SaveRequest {\n    lateinit var user: String\n    lateinit var url: String\n    var rate: Int by Delegates.notNull()\n    lateinit var timestamp: String\n}\n\nclass SaveHandler: DataHandler<SaveRequest, Any> {\n    override fun handleRequest(input: SaveRequest, context: Context): ResponseData<Any> {\n\n        val timestamp = try {\n            ZonedDateTime.parse(input.timestamp, DateTimeFormatter.ISO_DATE_TIME)\n        } catch (e: Exception) {\n            return ResponseData(mapOf(\"status\" to \"error\", \"desc\" to \"date time parsing failed.\"), StatusCode.BadRequest)\n        }\n\n        val dynamoDB = DynamoDB(Regions.US_EAST_1)\n        val t = dynamoDB.getTable(\"pages\")\n        val item = Item.fromMap(mapOf(\"user\" to input.user, \"url\" to input.url, \"rate\" to input.rate, \"epoch\" to timestamp.toEpochSecond(), \"timezone\" to timestamp.offset.totalSeconds))\n        val result = t.putItem(item)\n\n        return ResponseData(mapOf(\"status\" to \"success\", \"input\" to input))\n    }\n}\n```\n\n`SaveHandler`がリクエストハンドラーで、`SaveRequest`がリクエストに期待される内容ですね。言うまでもないか。\n\nAPI Gateway経由なのでJSONを渡されそうなものですが、実際はアマゾンがPOJOに突っ込んだうえで渡してくれます。Serverlessの設定として書くべきことも特になくて、本当にこのままLambdaにデプロイすれば面倒をみてくれます。DynamoDBもIAMさえ弄ればコードは1行で終わり。\n\nたったこれだけで (金さえ払えば) 無敵のスケーラビリティが手に入っちゃう。スゴイ！\n\nただしアマゾン様といえどもdata classのコンストラクタを使うような器用な芸当は当然やれないので、`SaveRequest`はプロパティ全てvarのクラスになっています。もっともここは`val hoge: String by Delegates.notNull()` の方がいいような気もするし、Web APIなんだから`String?`の方がかえってロジカルに書きやすいような気もするし、その辺りは僕もまだ深く考えてません。\n\nそこまでkotlinやAWSの挙動に詳しくないという事情もある。\n\nそれはともかく戻り値が`Any`になっていて許せん！という人もいると思いますが、これはmapOfで手軽に返したかったのです。データクラスとか指定すればちゃんと型安全で動きます (たぶん)。\n\nまあこの辺りは趣味の問題でもあり、生産性を上げるために工夫のしどころでもあります。`ResponseData`を使わず自前で実装する方がいいかもですね、ステータスコードは引数じゃなくて型に結びつけるとか。あるいはハンドラーの方にヘルパーをバシバシ生やすとか… \n\nその辺は今後ちょっと便利になったらいいかなあ。いいアイデアあったらPRください。\n\n\n\nで、コードはもう特に書くことないので思い出をつらつらと。\n\n## API Gateway -> Lambda -> Error!\n\n`sls invoke -f hello` が動くぞ！やったー！などと隙を見せたエンジニアを強襲するAWS！\n\n> Malformed Lambda proxy response\n\nlambdaとしては呼べるけどcurlすると落ちる。\n\nServerless使って一番つらかったのはコレ。Kotlin + Serverless + API Gatewayなんて実際に使っているケースがほぼ見つからない上に、数ヶ月前の記事で「動きました！簡単」とか書いてあるコードがもう動かない。嘘だゾ、全然簡単じゃないゾ。\n\n\nということで頑張って検索して探したのがコレ。~~人柱サンキュー！~~\n\n{% blockquote kyl191 https://forums.aws.amazon.com/thread.jspa?threadID=239688 AWS Developer Forums: Lambda Proxy Expectations %}\nOk, I found some documentation which says it expects statusCode, body and headers in a dict.\n{% endblockquote %}\n\n何でこんな状態なのか、ちょっと意味が分からないんですけど、API Gateway (Lambda Proxy) から呼ばれるLambdaは**戻り値の型はどうでもいいしインターフェイスとかないけど、statusCode body headersという3つの値を持っていないと実行時エラーになる**という凡そJavaとは思われない動的な仕組みになっているみたいです。\n\nつまり、`sls invoke -f hello`の結果として\n\n```json\n{\"hage\": [\"ok\", \"cool\", \"amazing\"]}\n```\n\nみたいな結果が見えている場合はダメです。\n\nLambdaとしては動いているのですが、Gateway経由で呼びたいなら以下の内容でなければいけません。\n\n\n```json\n{\n    \"body\": {\n        \"hage\": [\"ok\", \"cool\", \"amazing\"]\n    },\n    \"headers\": {},\n    \"statusCode\": 400\n}\n```\n\nこのフォーマットを守らなければ、Lambda ProxyモードのAPI Gatewayは有効な結果として受け付けてくれないのです。理屈が分かってしまえば納得できますが、この落とし穴だけは本当にひどい罠だと思います。\n\n一旦Lambda側からJSONを出力した上で、それを改めてGateway側がチェックするんでしょうか？ 色々と想像してますが謎です。\n\nちなみにデータのJSON化はあっちがJacksonでやってくれるので、上記のようなプロパティを持つPOJOを投げればいいみたいです。kotlinならdata classですね。あと試していませんがmapでも大丈夫かなと。\n\nただまあ、そこを自由にしても特に利点がなさそうなうえ、誰の目にも明らかにバグの温床でしかありません。今回のラッパーでは3つのプロパティを明示的に要求するインターフェイスを作っておきました。そもそも本来こういう仕様になってなきゃJavaコードとしておかしいと思うんですけど、それはそれで公式SDKとしては狭すぎる感じもありますからね… まあ気持ちはわかります。クソですけど。\n\nLambdaプロキシ自体が割と新しい機能であることも考えると仕方ない、AWSはこういうものなのだ… と割り切りましょう。\n\n## 2つの型パラメータを持つジェネリッククラスでないとエラーになる\n\nもうエラーログが手元にないんですが、リクエストハンドラーとして型パラメータ1つのクラスを作ってみたら「型パラメータは2つないと困るんだよなァ！」みたいな激おこメッセージを飛ばしてきました。これまたちょっと意味が分からないんですけど、JSONをリクエストPOJOに変換するときに型パラメータを使おうとしているのかな？ とにかくダメなものはダメらしいです。\n\nそれにしたって型パラメータ2つじゃないとダメっておかしくねえか？設計どうなってんの？という気もしますが仕方ない、AWSはこういうものなのだ… と割り切りましょう。\n\n## Internal Server Error\nAPI Gatewayを通過して結果が戻ってくるまでの間にエラーが発生するとInternal Server Errorです。例えば「Lambda処理内でリクエストパラメータを参照したらnull例外で落ちた」とかいう場合、それはInternal Server Errorであり、Gatewayのデフォルト処理が走って超ダサいJSONを投げ返します。\n\nサーバー内部でエラーが発生するなら、API Gatewayの視点からは全てInternal Server Errorなのです。まあそりゃ当然の挙動なんですけど、それはAPIを書く側からするとBadRequestだし、そもそも勝手にダサいJSONを流されるのも困ります。\n\nということでつまり、ハンドラ全体をtryで囲わないと不安だし、リクエスト内容の処理もちゃんと書かないといけません。当たり前の話とはいえ若干ちょっと面倒そう…\n\nその辺りをうまく集約できるインターフェイスとか作らないと大変そうですね。まあもちろん「ステータスコードさえ取れるなら大丈夫、後はYAGNI」という考え方もあると思います。その辺りの線引きはちょっと難しそう。\n\n## ということで\n\nなんか動くものは作れそうだし頑張る。","source":"_posts/20161211.md","raw":"---\ntitle: Kotlin + AWS Lambda + API GatewayでServerlessできちゃうラッパー公開したのでDynamoDBとか使っちゃう\npermalink: 1\ndate: 2016-12-11 12:36:08\ntags:\n- Kotlin\n- AWS\n---\n\nタイトルの通りです。[githubに置いてある](https://github.com/tottokotkd/GatewayHandler)し、[Bintray経由でjcenterにもある](https://bintray.com/bintray/jcenter?filterByPkgName=GatewayHandler)ので使えます。この公開ルートは今回初めてやってみましたが、なかなか便利ですね。\n\nもちろん公開するだけならgithubページでもイケるんですけど、その作業が手間だったり、IntelliJくんがキャッシュ持つ段階でエラー吐いたり、面倒なのでBintrayです。今はあんまりそこを頑張りたくなかった、仕方なかった。\n\ngithubの方に書いてあるんですけど、コードでいうとこんな感じ。\n\n```kotlin\npackage hello\n\nimport com.amazonaws.regions.Regions\nimport com.amazonaws.services.dynamodbv2.document.DynamoDB\nimport com.amazonaws.services.dynamodbv2.document.Item\nimport com.amazonaws.services.lambda.runtime.Context\nimport com.tottokotkd.aws.gateway.core.*\nimport java.time.ZonedDateTime\nimport java.time.format.DateTimeFormatter\nimport kotlin.properties.Delegates\n\nclass SaveRequest {\n    lateinit var user: String\n    lateinit var url: String\n    var rate: Int by Delegates.notNull()\n    lateinit var timestamp: String\n}\n\nclass SaveHandler: DataHandler<SaveRequest, Any> {\n    override fun handleRequest(input: SaveRequest, context: Context): ResponseData<Any> {\n\n        val timestamp = try {\n            ZonedDateTime.parse(input.timestamp, DateTimeFormatter.ISO_DATE_TIME)\n        } catch (e: Exception) {\n            return ResponseData(mapOf(\"status\" to \"error\", \"desc\" to \"date time parsing failed.\"), StatusCode.BadRequest)\n        }\n\n        val dynamoDB = DynamoDB(Regions.US_EAST_1)\n        val t = dynamoDB.getTable(\"pages\")\n        val item = Item.fromMap(mapOf(\"user\" to input.user, \"url\" to input.url, \"rate\" to input.rate, \"epoch\" to timestamp.toEpochSecond(), \"timezone\" to timestamp.offset.totalSeconds))\n        val result = t.putItem(item)\n\n        return ResponseData(mapOf(\"status\" to \"success\", \"input\" to input))\n    }\n}\n```\n\n`SaveHandler`がリクエストハンドラーで、`SaveRequest`がリクエストに期待される内容ですね。言うまでもないか。\n\nAPI Gateway経由なのでJSONを渡されそうなものですが、実際はアマゾンがPOJOに突っ込んだうえで渡してくれます。Serverlessの設定として書くべきことも特になくて、本当にこのままLambdaにデプロイすれば面倒をみてくれます。DynamoDBもIAMさえ弄ればコードは1行で終わり。\n\nたったこれだけで (金さえ払えば) 無敵のスケーラビリティが手に入っちゃう。スゴイ！\n\nただしアマゾン様といえどもdata classのコンストラクタを使うような器用な芸当は当然やれないので、`SaveRequest`はプロパティ全てvarのクラスになっています。もっともここは`val hoge: String by Delegates.notNull()` の方がいいような気もするし、Web APIなんだから`String?`の方がかえってロジカルに書きやすいような気もするし、その辺りは僕もまだ深く考えてません。\n\nそこまでkotlinやAWSの挙動に詳しくないという事情もある。\n\nそれはともかく戻り値が`Any`になっていて許せん！という人もいると思いますが、これはmapOfで手軽に返したかったのです。データクラスとか指定すればちゃんと型安全で動きます (たぶん)。\n\nまあこの辺りは趣味の問題でもあり、生産性を上げるために工夫のしどころでもあります。`ResponseData`を使わず自前で実装する方がいいかもですね、ステータスコードは引数じゃなくて型に結びつけるとか。あるいはハンドラーの方にヘルパーをバシバシ生やすとか… \n\nその辺は今後ちょっと便利になったらいいかなあ。いいアイデアあったらPRください。\n\n\n\nで、コードはもう特に書くことないので思い出をつらつらと。\n\n## API Gateway -> Lambda -> Error!\n\n`sls invoke -f hello` が動くぞ！やったー！などと隙を見せたエンジニアを強襲するAWS！\n\n> Malformed Lambda proxy response\n\nlambdaとしては呼べるけどcurlすると落ちる。\n\nServerless使って一番つらかったのはコレ。Kotlin + Serverless + API Gatewayなんて実際に使っているケースがほぼ見つからない上に、数ヶ月前の記事で「動きました！簡単」とか書いてあるコードがもう動かない。嘘だゾ、全然簡単じゃないゾ。\n\n\nということで頑張って検索して探したのがコレ。~~人柱サンキュー！~~\n\n{% blockquote kyl191 https://forums.aws.amazon.com/thread.jspa?threadID=239688 AWS Developer Forums: Lambda Proxy Expectations %}\nOk, I found some documentation which says it expects statusCode, body and headers in a dict.\n{% endblockquote %}\n\n何でこんな状態なのか、ちょっと意味が分からないんですけど、API Gateway (Lambda Proxy) から呼ばれるLambdaは**戻り値の型はどうでもいいしインターフェイスとかないけど、statusCode body headersという3つの値を持っていないと実行時エラーになる**という凡そJavaとは思われない動的な仕組みになっているみたいです。\n\nつまり、`sls invoke -f hello`の結果として\n\n```json\n{\"hage\": [\"ok\", \"cool\", \"amazing\"]}\n```\n\nみたいな結果が見えている場合はダメです。\n\nLambdaとしては動いているのですが、Gateway経由で呼びたいなら以下の内容でなければいけません。\n\n\n```json\n{\n    \"body\": {\n        \"hage\": [\"ok\", \"cool\", \"amazing\"]\n    },\n    \"headers\": {},\n    \"statusCode\": 400\n}\n```\n\nこのフォーマットを守らなければ、Lambda ProxyモードのAPI Gatewayは有効な結果として受け付けてくれないのです。理屈が分かってしまえば納得できますが、この落とし穴だけは本当にひどい罠だと思います。\n\n一旦Lambda側からJSONを出力した上で、それを改めてGateway側がチェックするんでしょうか？ 色々と想像してますが謎です。\n\nちなみにデータのJSON化はあっちがJacksonでやってくれるので、上記のようなプロパティを持つPOJOを投げればいいみたいです。kotlinならdata classですね。あと試していませんがmapでも大丈夫かなと。\n\nただまあ、そこを自由にしても特に利点がなさそうなうえ、誰の目にも明らかにバグの温床でしかありません。今回のラッパーでは3つのプロパティを明示的に要求するインターフェイスを作っておきました。そもそも本来こういう仕様になってなきゃJavaコードとしておかしいと思うんですけど、それはそれで公式SDKとしては狭すぎる感じもありますからね… まあ気持ちはわかります。クソですけど。\n\nLambdaプロキシ自体が割と新しい機能であることも考えると仕方ない、AWSはこういうものなのだ… と割り切りましょう。\n\n## 2つの型パラメータを持つジェネリッククラスでないとエラーになる\n\nもうエラーログが手元にないんですが、リクエストハンドラーとして型パラメータ1つのクラスを作ってみたら「型パラメータは2つないと困るんだよなァ！」みたいな激おこメッセージを飛ばしてきました。これまたちょっと意味が分からないんですけど、JSONをリクエストPOJOに変換するときに型パラメータを使おうとしているのかな？ とにかくダメなものはダメらしいです。\n\nそれにしたって型パラメータ2つじゃないとダメっておかしくねえか？設計どうなってんの？という気もしますが仕方ない、AWSはこういうものなのだ… と割り切りましょう。\n\n## Internal Server Error\nAPI Gatewayを通過して結果が戻ってくるまでの間にエラーが発生するとInternal Server Errorです。例えば「Lambda処理内でリクエストパラメータを参照したらnull例外で落ちた」とかいう場合、それはInternal Server Errorであり、Gatewayのデフォルト処理が走って超ダサいJSONを投げ返します。\n\nサーバー内部でエラーが発生するなら、API Gatewayの視点からは全てInternal Server Errorなのです。まあそりゃ当然の挙動なんですけど、それはAPIを書く側からするとBadRequestだし、そもそも勝手にダサいJSONを流されるのも困ります。\n\nということでつまり、ハンドラ全体をtryで囲わないと不安だし、リクエスト内容の処理もちゃんと書かないといけません。当たり前の話とはいえ若干ちょっと面倒そう…\n\nその辺りをうまく集約できるインターフェイスとか作らないと大変そうですね。まあもちろん「ステータスコードさえ取れるなら大丈夫、後はYAGNI」という考え方もあると思います。その辺りの線引きはちょっと難しそう。\n\n## ということで\n\nなんか動くものは作れそうだし頑張る。","slug":"1","published":1,"updated":"2017-02-21T11:56:03.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cizfk5co70009thc1y4885psw","content":"<p>タイトルの通りです。<a href=\"https://github.com/tottokotkd/GatewayHandler\" target=\"_blank\" rel=\"external\">githubに置いてある</a>し、<a href=\"https://bintray.com/bintray/jcenter?filterByPkgName=GatewayHandler\" target=\"_blank\" rel=\"external\">Bintray経由でjcenterにもある</a>ので使えます。この公開ルートは今回初めてやってみましたが、なかなか便利ですね。</p>\n<p>もちろん公開するだけならgithubページでもイケるんですけど、その作業が手間だったり、IntelliJくんがキャッシュ持つ段階でエラー吐いたり、面倒なのでBintrayです。今はあんまりそこを頑張りたくなかった、仕方なかった。</p>\n<p>githubの方に書いてあるんですけど、コードでいうとこんな感じ。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> hello</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> com.amazonaws.regions.Regions</div><div class=\"line\"><span class=\"keyword\">import</span> com.amazonaws.services.dynamodbv2.document.DynamoDB</div><div class=\"line\"><span class=\"keyword\">import</span> com.amazonaws.services.dynamodbv2.document.Item</div><div class=\"line\"><span class=\"keyword\">import</span> com.amazonaws.services.lambda.runtime.Context</div><div class=\"line\"><span class=\"keyword\">import</span> com.tottokotkd.aws.gateway.core.*</div><div class=\"line\"><span class=\"keyword\">import</span> java.time.ZonedDateTime</div><div class=\"line\"><span class=\"keyword\">import</span> java.time.format.DateTimeFormatter</div><div class=\"line\"><span class=\"keyword\">import</span> kotlin.properties.Delegates</div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SaveRequest</span> </span>&#123;</div><div class=\"line\">    lateinit <span class=\"keyword\">var</span> user: String</div><div class=\"line\">    lateinit <span class=\"keyword\">var</span> url: String</div><div class=\"line\">    <span class=\"keyword\">var</span> rate: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> Delegates.notNull()</div><div class=\"line\">    lateinit <span class=\"keyword\">var</span> timestamp: String</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SaveHandler</span>: <span class=\"type\">DataHandler</span>&lt;<span class=\"type\">SaveRequest, Any</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">handleRequest</span><span class=\"params\">(input: <span class=\"type\">SaveRequest</span>, context: <span class=\"type\">Context</span>)</span></span>: ResponseData&lt;Any&gt; &#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">val</span> timestamp = <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            ZonedDateTime.parse(input.timestamp, DateTimeFormatter.ISO_DATE_TIME)</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e: Exception) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> ResponseData(mapOf(<span class=\"string\">\"status\"</span> to <span class=\"string\">\"error\"</span>, <span class=\"string\">\"desc\"</span> to <span class=\"string\">\"date time parsing failed.\"</span>), StatusCode.BadRequest)</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">val</span> dynamoDB = DynamoDB(Regions.US_EAST_1)</div><div class=\"line\">        <span class=\"keyword\">val</span> t = dynamoDB.getTable(<span class=\"string\">\"pages\"</span>)</div><div class=\"line\">        <span class=\"keyword\">val</span> item = Item.fromMap(mapOf(<span class=\"string\">\"user\"</span> to input.user, <span class=\"string\">\"url\"</span> to input.url, <span class=\"string\">\"rate\"</span> to input.rate, <span class=\"string\">\"epoch\"</span> to timestamp.toEpochSecond(), <span class=\"string\">\"timezone\"</span> to timestamp.offset.totalSeconds))</div><div class=\"line\">        <span class=\"keyword\">val</span> result = t.putItem(item)</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> ResponseData(mapOf(<span class=\"string\">\"status\"</span> to <span class=\"string\">\"success\"</span>, <span class=\"string\">\"input\"</span> to input))</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><code>SaveHandler</code>がリクエストハンドラーで、<code>SaveRequest</code>がリクエストに期待される内容ですね。言うまでもないか。</p>\n<p>API Gateway経由なのでJSONを渡されそうなものですが、実際はアマゾンがPOJOに突っ込んだうえで渡してくれます。Serverlessの設定として書くべきことも特になくて、本当にこのままLambdaにデプロイすれば面倒をみてくれます。DynamoDBもIAMさえ弄ればコードは1行で終わり。</p>\n<p>たったこれだけで (金さえ払えば) 無敵のスケーラビリティが手に入っちゃう。スゴイ！</p>\n<p>ただしアマゾン様といえどもdata classのコンストラクタを使うような器用な芸当は当然やれないので、<code>SaveRequest</code>はプロパティ全てvarのクラスになっています。もっともここは<code>val hoge: String by Delegates.notNull()</code> の方がいいような気もするし、Web APIなんだから<code>String?</code>の方がかえってロジカルに書きやすいような気もするし、その辺りは僕もまだ深く考えてません。</p>\n<p>そこまでkotlinやAWSの挙動に詳しくないという事情もある。</p>\n<p>それはともかく戻り値が<code>Any</code>になっていて許せん！という人もいると思いますが、これはmapOfで手軽に返したかったのです。データクラスとか指定すればちゃんと型安全で動きます (たぶん)。</p>\n<p>まあこの辺りは趣味の問題でもあり、生産性を上げるために工夫のしどころでもあります。<code>ResponseData</code>を使わず自前で実装する方がいいかもですね、ステータスコードは引数じゃなくて型に結びつけるとか。あるいはハンドラーの方にヘルパーをバシバシ生やすとか… </p>\n<p>その辺は今後ちょっと便利になったらいいかなあ。いいアイデアあったらPRください。</p>\n<p>で、コードはもう特に書くことないので思い出をつらつらと。</p>\n<h2 id=\"API-Gateway-gt-Lambda-gt-Error\"><a href=\"#API-Gateway-gt-Lambda-gt-Error\" class=\"headerlink\" title=\"API Gateway -&gt; Lambda -&gt; Error!\"></a>API Gateway -&gt; Lambda -&gt; Error!</h2><p><code>sls invoke -f hello</code> が動くぞ！やったー！などと隙を見せたエンジニアを強襲するAWS！</p>\n<blockquote>\n<p>Malformed Lambda proxy response</p>\n</blockquote>\n<p>lambdaとしては呼べるけどcurlすると落ちる。</p>\n<p>Serverless使って一番つらかったのはコレ。Kotlin + Serverless + API Gatewayなんて実際に使っているケースがほぼ見つからない上に、数ヶ月前の記事で「動きました！簡単」とか書いてあるコードがもう動かない。嘘だゾ、全然簡単じゃないゾ。</p>\n<p>ということで頑張って検索して探したのがコレ。<del>人柱サンキュー！</del></p>\n<blockquote><p>Ok, I found some documentation which says it expects statusCode, body and headers in a dict.</p>\n<footer><strong>kyl191</strong><cite><a href=\"https://forums.aws.amazon.com/thread.jspa?threadID=239688\" target=\"_blank\" rel=\"external\">AWS Developer Forums: Lambda Proxy Expectations</a></cite></footer></blockquote>\n<p>何でこんな状態なのか、ちょっと意味が分からないんですけど、API Gateway (Lambda Proxy) から呼ばれるLambdaは<strong>戻り値の型はどうでもいいしインターフェイスとかないけど、statusCode body headersという3つの値を持っていないと実行時エラーになる</strong>という凡そJavaとは思われない動的な仕組みになっているみたいです。</p>\n<p>つまり、<code>sls invoke -f hello</code>の結果として</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123;<span class=\"attr\">\"hage\"</span>: [<span class=\"string\">\"ok\"</span>, <span class=\"string\">\"cool\"</span>, <span class=\"string\">\"amazing\"</span>]&#125;</div></pre></td></tr></table></figure>\n<p>みたいな結果が見えている場合はダメです。</p>\n<p>Lambdaとしては動いているのですが、Gateway経由で呼びたいなら以下の内容でなければいけません。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"attr\">\"body\"</span>: &#123;</div><div class=\"line\">        <span class=\"attr\">\"hage\"</span>: [<span class=\"string\">\"ok\"</span>, <span class=\"string\">\"cool\"</span>, <span class=\"string\">\"amazing\"</span>]</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">\"headers\"</span>: &#123;&#125;,</div><div class=\"line\">    <span class=\"attr\">\"statusCode\"</span>: <span class=\"number\">400</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>このフォーマットを守らなければ、Lambda ProxyモードのAPI Gatewayは有効な結果として受け付けてくれないのです。理屈が分かってしまえば納得できますが、この落とし穴だけは本当にひどい罠だと思います。</p>\n<p>一旦Lambda側からJSONを出力した上で、それを改めてGateway側がチェックするんでしょうか？ 色々と想像してますが謎です。</p>\n<p>ちなみにデータのJSON化はあっちがJacksonでやってくれるので、上記のようなプロパティを持つPOJOを投げればいいみたいです。kotlinならdata classですね。あと試していませんがmapでも大丈夫かなと。</p>\n<p>ただまあ、そこを自由にしても特に利点がなさそうなうえ、誰の目にも明らかにバグの温床でしかありません。今回のラッパーでは3つのプロパティを明示的に要求するインターフェイスを作っておきました。そもそも本来こういう仕様になってなきゃJavaコードとしておかしいと思うんですけど、それはそれで公式SDKとしては狭すぎる感じもありますからね… まあ気持ちはわかります。クソですけど。</p>\n<p>Lambdaプロキシ自体が割と新しい機能であることも考えると仕方ない、AWSはこういうものなのだ… と割り切りましょう。</p>\n<h2 id=\"2つの型パラメータを持つジェネリッククラスでないとエラーになる\"><a href=\"#2つの型パラメータを持つジェネリッククラスでないとエラーになる\" class=\"headerlink\" title=\"2つの型パラメータを持つジェネリッククラスでないとエラーになる\"></a>2つの型パラメータを持つジェネリッククラスでないとエラーになる</h2><p>もうエラーログが手元にないんですが、リクエストハンドラーとして型パラメータ1つのクラスを作ってみたら「型パラメータは2つないと困るんだよなァ！」みたいな激おこメッセージを飛ばしてきました。これまたちょっと意味が分からないんですけど、JSONをリクエストPOJOに変換するときに型パラメータを使おうとしているのかな？ とにかくダメなものはダメらしいです。</p>\n<p>それにしたって型パラメータ2つじゃないとダメっておかしくねえか？設計どうなってんの？という気もしますが仕方ない、AWSはこういうものなのだ… と割り切りましょう。</p>\n<h2 id=\"Internal-Server-Error\"><a href=\"#Internal-Server-Error\" class=\"headerlink\" title=\"Internal Server Error\"></a>Internal Server Error</h2><p>API Gatewayを通過して結果が戻ってくるまでの間にエラーが発生するとInternal Server Errorです。例えば「Lambda処理内でリクエストパラメータを参照したらnull例外で落ちた」とかいう場合、それはInternal Server Errorであり、Gatewayのデフォルト処理が走って超ダサいJSONを投げ返します。</p>\n<p>サーバー内部でエラーが発生するなら、API Gatewayの視点からは全てInternal Server Errorなのです。まあそりゃ当然の挙動なんですけど、それはAPIを書く側からするとBadRequestだし、そもそも勝手にダサいJSONを流されるのも困ります。</p>\n<p>ということでつまり、ハンドラ全体をtryで囲わないと不安だし、リクエスト内容の処理もちゃんと書かないといけません。当たり前の話とはいえ若干ちょっと面倒そう…</p>\n<p>その辺りをうまく集約できるインターフェイスとか作らないと大変そうですね。まあもちろん「ステータスコードさえ取れるなら大丈夫、後はYAGNI」という考え方もあると思います。その辺りの線引きはちょっと難しそう。</p>\n<h2 id=\"ということで\"><a href=\"#ということで\" class=\"headerlink\" title=\"ということで\"></a>ということで</h2><p>なんか動くものは作れそうだし頑張る。</p>\n","excerpt":"","more":"<p>タイトルの通りです。<a href=\"https://github.com/tottokotkd/GatewayHandler\">githubに置いてある</a>し、<a href=\"https://bintray.com/bintray/jcenter?filterByPkgName=GatewayHandler\">Bintray経由でjcenterにもある</a>ので使えます。この公開ルートは今回初めてやってみましたが、なかなか便利ですね。</p>\n<p>もちろん公開するだけならgithubページでもイケるんですけど、その作業が手間だったり、IntelliJくんがキャッシュ持つ段階でエラー吐いたり、面倒なのでBintrayです。今はあんまりそこを頑張りたくなかった、仕方なかった。</p>\n<p>githubの方に書いてあるんですけど、コードでいうとこんな感じ。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> hello</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> com.amazonaws.regions.Regions</div><div class=\"line\"><span class=\"keyword\">import</span> com.amazonaws.services.dynamodbv2.document.DynamoDB</div><div class=\"line\"><span class=\"keyword\">import</span> com.amazonaws.services.dynamodbv2.document.Item</div><div class=\"line\"><span class=\"keyword\">import</span> com.amazonaws.services.lambda.runtime.Context</div><div class=\"line\"><span class=\"keyword\">import</span> com.tottokotkd.aws.gateway.core.*</div><div class=\"line\"><span class=\"keyword\">import</span> java.time.ZonedDateTime</div><div class=\"line\"><span class=\"keyword\">import</span> java.time.format.DateTimeFormatter</div><div class=\"line\"><span class=\"keyword\">import</span> kotlin.properties.Delegates</div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SaveRequest</span> </span>&#123;</div><div class=\"line\">    lateinit <span class=\"keyword\">var</span> user: String</div><div class=\"line\">    lateinit <span class=\"keyword\">var</span> url: String</div><div class=\"line\">    <span class=\"keyword\">var</span> rate: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> Delegates.notNull()</div><div class=\"line\">    lateinit <span class=\"keyword\">var</span> timestamp: String</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SaveHandler</span>: <span class=\"type\">DataHandler</span>&lt;<span class=\"type\">SaveRequest, Any</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">handleRequest</span><span class=\"params\">(input: <span class=\"type\">SaveRequest</span>, context: <span class=\"type\">Context</span>)</span></span>: ResponseData&lt;Any&gt; &#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">val</span> timestamp = <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            ZonedDateTime.parse(input.timestamp, DateTimeFormatter.ISO_DATE_TIME)</div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e: Exception) &#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> ResponseData(mapOf(<span class=\"string\">\"status\"</span> to <span class=\"string\">\"error\"</span>, <span class=\"string\">\"desc\"</span> to <span class=\"string\">\"date time parsing failed.\"</span>), StatusCode.BadRequest)</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">val</span> dynamoDB = DynamoDB(Regions.US_EAST_1)</div><div class=\"line\">        <span class=\"keyword\">val</span> t = dynamoDB.getTable(<span class=\"string\">\"pages\"</span>)</div><div class=\"line\">        <span class=\"keyword\">val</span> item = Item.fromMap(mapOf(<span class=\"string\">\"user\"</span> to input.user, <span class=\"string\">\"url\"</span> to input.url, <span class=\"string\">\"rate\"</span> to input.rate, <span class=\"string\">\"epoch\"</span> to timestamp.toEpochSecond(), <span class=\"string\">\"timezone\"</span> to timestamp.offset.totalSeconds))</div><div class=\"line\">        <span class=\"keyword\">val</span> result = t.putItem(item)</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> ResponseData(mapOf(<span class=\"string\">\"status\"</span> to <span class=\"string\">\"success\"</span>, <span class=\"string\">\"input\"</span> to input))</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><code>SaveHandler</code>がリクエストハンドラーで、<code>SaveRequest</code>がリクエストに期待される内容ですね。言うまでもないか。</p>\n<p>API Gateway経由なのでJSONを渡されそうなものですが、実際はアマゾンがPOJOに突っ込んだうえで渡してくれます。Serverlessの設定として書くべきことも特になくて、本当にこのままLambdaにデプロイすれば面倒をみてくれます。DynamoDBもIAMさえ弄ればコードは1行で終わり。</p>\n<p>たったこれだけで (金さえ払えば) 無敵のスケーラビリティが手に入っちゃう。スゴイ！</p>\n<p>ただしアマゾン様といえどもdata classのコンストラクタを使うような器用な芸当は当然やれないので、<code>SaveRequest</code>はプロパティ全てvarのクラスになっています。もっともここは<code>val hoge: String by Delegates.notNull()</code> の方がいいような気もするし、Web APIなんだから<code>String?</code>の方がかえってロジカルに書きやすいような気もするし、その辺りは僕もまだ深く考えてません。</p>\n<p>そこまでkotlinやAWSの挙動に詳しくないという事情もある。</p>\n<p>それはともかく戻り値が<code>Any</code>になっていて許せん！という人もいると思いますが、これはmapOfで手軽に返したかったのです。データクラスとか指定すればちゃんと型安全で動きます (たぶん)。</p>\n<p>まあこの辺りは趣味の問題でもあり、生産性を上げるために工夫のしどころでもあります。<code>ResponseData</code>を使わず自前で実装する方がいいかもですね、ステータスコードは引数じゃなくて型に結びつけるとか。あるいはハンドラーの方にヘルパーをバシバシ生やすとか… </p>\n<p>その辺は今後ちょっと便利になったらいいかなあ。いいアイデアあったらPRください。</p>\n<p>で、コードはもう特に書くことないので思い出をつらつらと。</p>\n<h2 id=\"API-Gateway-gt-Lambda-gt-Error\"><a href=\"#API-Gateway-gt-Lambda-gt-Error\" class=\"headerlink\" title=\"API Gateway -&gt; Lambda -&gt; Error!\"></a>API Gateway -&gt; Lambda -&gt; Error!</h2><p><code>sls invoke -f hello</code> が動くぞ！やったー！などと隙を見せたエンジニアを強襲するAWS！</p>\n<blockquote>\n<p>Malformed Lambda proxy response</p>\n</blockquote>\n<p>lambdaとしては呼べるけどcurlすると落ちる。</p>\n<p>Serverless使って一番つらかったのはコレ。Kotlin + Serverless + API Gatewayなんて実際に使っているケースがほぼ見つからない上に、数ヶ月前の記事で「動きました！簡単」とか書いてあるコードがもう動かない。嘘だゾ、全然簡単じゃないゾ。</p>\n<p>ということで頑張って検索して探したのがコレ。<del>人柱サンキュー！</del></p>\n<blockquote><p>Ok, I found some documentation which says it expects statusCode, body and headers in a dict.</p>\n<footer><strong>kyl191</strong><cite><a href=\"https://forums.aws.amazon.com/thread.jspa?threadID=239688\">AWS Developer Forums: Lambda Proxy Expectations</a></cite></footer></blockquote>\n<p>何でこんな状態なのか、ちょっと意味が分からないんですけど、API Gateway (Lambda Proxy) から呼ばれるLambdaは<strong>戻り値の型はどうでもいいしインターフェイスとかないけど、statusCode body headersという3つの値を持っていないと実行時エラーになる</strong>という凡そJavaとは思われない動的な仕組みになっているみたいです。</p>\n<p>つまり、<code>sls invoke -f hello</code>の結果として</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123;<span class=\"attr\">\"hage\"</span>: [<span class=\"string\">\"ok\"</span>, <span class=\"string\">\"cool\"</span>, <span class=\"string\">\"amazing\"</span>]&#125;</div></pre></td></tr></table></figure>\n<p>みたいな結果が見えている場合はダメです。</p>\n<p>Lambdaとしては動いているのですが、Gateway経由で呼びたいなら以下の内容でなければいけません。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"attr\">\"body\"</span>: &#123;</div><div class=\"line\">        <span class=\"attr\">\"hage\"</span>: [<span class=\"string\">\"ok\"</span>, <span class=\"string\">\"cool\"</span>, <span class=\"string\">\"amazing\"</span>]</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">\"headers\"</span>: &#123;&#125;,</div><div class=\"line\">    <span class=\"attr\">\"statusCode\"</span>: <span class=\"number\">400</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>このフォーマットを守らなければ、Lambda ProxyモードのAPI Gatewayは有効な結果として受け付けてくれないのです。理屈が分かってしまえば納得できますが、この落とし穴だけは本当にひどい罠だと思います。</p>\n<p>一旦Lambda側からJSONを出力した上で、それを改めてGateway側がチェックするんでしょうか？ 色々と想像してますが謎です。</p>\n<p>ちなみにデータのJSON化はあっちがJacksonでやってくれるので、上記のようなプロパティを持つPOJOを投げればいいみたいです。kotlinならdata classですね。あと試していませんがmapでも大丈夫かなと。</p>\n<p>ただまあ、そこを自由にしても特に利点がなさそうなうえ、誰の目にも明らかにバグの温床でしかありません。今回のラッパーでは3つのプロパティを明示的に要求するインターフェイスを作っておきました。そもそも本来こういう仕様になってなきゃJavaコードとしておかしいと思うんですけど、それはそれで公式SDKとしては狭すぎる感じもありますからね… まあ気持ちはわかります。クソですけど。</p>\n<p>Lambdaプロキシ自体が割と新しい機能であることも考えると仕方ない、AWSはこういうものなのだ… と割り切りましょう。</p>\n<h2 id=\"2つの型パラメータを持つジェネリッククラスでないとエラーになる\"><a href=\"#2つの型パラメータを持つジェネリッククラスでないとエラーになる\" class=\"headerlink\" title=\"2つの型パラメータを持つジェネリッククラスでないとエラーになる\"></a>2つの型パラメータを持つジェネリッククラスでないとエラーになる</h2><p>もうエラーログが手元にないんですが、リクエストハンドラーとして型パラメータ1つのクラスを作ってみたら「型パラメータは2つないと困るんだよなァ！」みたいな激おこメッセージを飛ばしてきました。これまたちょっと意味が分からないんですけど、JSONをリクエストPOJOに変換するときに型パラメータを使おうとしているのかな？ とにかくダメなものはダメらしいです。</p>\n<p>それにしたって型パラメータ2つじゃないとダメっておかしくねえか？設計どうなってんの？という気もしますが仕方ない、AWSはこういうものなのだ… と割り切りましょう。</p>\n<h2 id=\"Internal-Server-Error\"><a href=\"#Internal-Server-Error\" class=\"headerlink\" title=\"Internal Server Error\"></a>Internal Server Error</h2><p>API Gatewayを通過して結果が戻ってくるまでの間にエラーが発生するとInternal Server Errorです。例えば「Lambda処理内でリクエストパラメータを参照したらnull例外で落ちた」とかいう場合、それはInternal Server Errorであり、Gatewayのデフォルト処理が走って超ダサいJSONを投げ返します。</p>\n<p>サーバー内部でエラーが発生するなら、API Gatewayの視点からは全てInternal Server Errorなのです。まあそりゃ当然の挙動なんですけど、それはAPIを書く側からするとBadRequestだし、そもそも勝手にダサいJSONを流されるのも困ります。</p>\n<p>ということでつまり、ハンドラ全体をtryで囲わないと不安だし、リクエスト内容の処理もちゃんと書かないといけません。当たり前の話とはいえ若干ちょっと面倒そう…</p>\n<p>その辺りをうまく集約できるインターフェイスとか作らないと大変そうですね。まあもちろん「ステータスコードさえ取れるなら大丈夫、後はYAGNI」という考え方もあると思います。その辺りの線引きはちょっと難しそう。</p>\n<h2 id=\"ということで\"><a href=\"#ということで\" class=\"headerlink\" title=\"ということで\"></a>ということで</h2><p>なんか動くものは作れそうだし頑張る。</p>\n"},{"title":"あなたの担当ボイスはどこから？ 私は声あり同僚から！ シンデレラガールズをデータ分析で丸裸にしよう","description":"CG総合データベース構築プロジェクト \"hinapedia\" 成果物","date":"2017-02-21T12:09:08.000Z","_content":"\n「声なしアイドルって…」\n\n「ボイスの有無はもしかして…」\n\nそんなモヤモヤに今日こそオサラバ！ モバPの疑問にデータで答えます。\n\nこの高度情報化社会では何をするにもデータは不可欠… Pなら担当の統計情報を知ってて当然だよね！\n\nこの投稿は、自由で公平でオープンソースで現在製造中、シンデレラガールズ総合データベース \"[hinapedia](https://tottokotkd.gitlab.io/hinapedia/)\" 最新入力データに基づいています。疑問・提案・修正は [@tottokotkd](https://twitter.com/tottokotkd) まで。\n\ngitlabに詳しい方は直接issueを立てることもできます。詳しくは[ここ](https://tottokotkd.gitlab.io/hinapedia/info/)。\n\n---\n\n## 前提 (絶対ここから読めよ☆)\n\n### 収録データについて\n\n\"hinapedia\" が収録する「ユニット」データとは、大雑把にまとめると以下2つの条件を満たすもの全てです。だいたい2017年1月あたりまで入っています。\n\n* 公式が名前をつけている\n* 劇中劇 (モバマス公演) 由来ではない\n\n公演由来のデータが入っていないのは、端的に言えば「扱いが難しいから」です。以下のデータを見るときには「**まあそうは言っても公演でめっちゃ共演してるしな…**」とか「**このデータはちょっと古いしな…**」とか何とか、脳内でよしなに補正してください。\n\nまた現在の仕様上、例えば「ユニット16」と「Age16」は別々のユニットとして登録されています。つまり**細かい値はあんまり精確じゃない**ので重視せず、大雑把な全体的傾向を掴む方がいいです。「やったー誰それは1ポイント差で3位だー」とか言ってもあんまり意味ないかもしれません。何卒、何卒。\n\n\n### データの見方\n\nとりあえず最初にデータの読み方を確認しましょう。[リンクをクリックすると簡単に現物をチェックできる](https://tottokotkd.gitlab.io/hinapedia/#/idol)ので確かめてみてね。\n\n{% asset_img 0.png %}\n\n表のデータは左から順番に「属性、名前、年齢、身長、所属ユニット数、同僚アイドル人数 (重複なし) 、ボイスあり同僚アイドル人数 (重複なし) 、ボイスあり同僚アイドルの割合、参考リンク」となっています。表の上にあるのはフィルター・ソートの入力欄です。\n\n「重複なし」というのは、同じキャラを何回もカウントしないってことです。たとえば凛の同僚が卯月だらけになってしまっては困りますからね (そういう同人ありそうだけど) 。\n\n実はこの表がなかなかの力作で、クリックでソートできたりコピペできたりする凄いやつなんですけど… 関係ないですね、はい。\n\nでは早速データを眺めてモヤモヤを\u0010叩き潰していきましょう！ 以下全ての項目において、データのタイトルをクリックするとソースが出てきます。この機能もなかなか凄くて… あっ興味ないですね、はい。\n\n---\n\n## 声あり・声なしをデータで観察してみる\n日頃なんとなく気になっていたアレについて確かめてみよう！\n\n### モヤモヤ1. 声なしと声ありの絡みが少ない気がする\n \n**その通り。声ありの同僚は声ありが多く、声なしの同僚は声なしが多い。**人数も割合もそうである。\n\n#### [全体の平均値](https://tottokotkd.gitlab.io/hinapedia/#/idol)\n* 同僚19.41人\n* そのうち声あり同僚8.51人 (39.77%)\n\n#### [声あり](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue)\n* 同僚23.95人\n* そのうち声あり同僚15.69人 **(64.73%)**\n\n#### [声なし](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Afalse)\n\n* 同僚16.91人\n* そのうち声あり同僚4.55人 **(26.03%)**\n\n### ひとこと\nそもそも声なしは所属ユニット数が少ないので、同僚の合計人数が少ないのは仕方ないところ。でも割合まで低いのは注目すべきポイントですね。\n\n---\n\n## モヤモヤ2. 担当のユニット数が少ない or 多い気がする\n\n**事実かもしれない。ユニット所属数には差がある。**\n\n### [ユニット所属数が少ないアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?sort=unitCount%2520asc)\n\n* 4ユニット: 赤西瑛梨華、大石泉\n* 5ユニット: 安斎都、井村雪菜、岸部彩華、工藤忍、西川保奈美\n* 6ユニット: 伊集院惠、大西由里子、桐生つかさ、小松伊吹、土屋亜子、長富蓮実、松永涼、松原早耶\n* 7ユニット: 大原みちる、村松さくら、柳清良、水木聖來、水野翠、脇山珠美、愛野渚、南条光\n* 8ユニット: (多いため略。ソース参照)\n\n\n### [ユニット所属数が多いアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?sort=unitCount%2520desc)\n\n* 20ユニット: 片桐早苗、白坂小梅\n* 19ユニット: 高垣楓\n* 18ユニット: 大槻唯、櫻井桃華\n* 17ユニット: 市原仁奈、緒方智絵里、川島瑞樹、新田美波、姫川友紀、藤原肇、星輝子、堀裕子、龍崎薫\n* 16ユニット: 安部菜々、高橋礼子、ナターリア、宮本フレデリカ、向井拓海\n\n### ひとこと\nもしかすると「ユニット数が少ない＝不遇」という解釈をするかもしれませんが、「イベントに既存ユニットとして登場する機会が多いため、他のユニットが少ない」という解釈もあります。ニューウェーブとか。\n\nユニット数が多いとサプライズ的にボイスつけやすいのかな？\n\n## モヤモヤ3. 声ありと絡まないと声はつかない気がする\n\n**そんなことはない。ただキャラクターの人間関係が固定化されているだけである。**\n\n### [「声あり同僚」の割合が少ない、声ありアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&sort=cvColleagueRate%2520asc)\n* 20%以下: 脇山珠美\n* 30%以下: 水本ゆかり、及川雫、龍崎薫\n* 40%以下: 佐々木千枝、上条春菜、森久保乃々、難波笑美、上田鈴帆、木村夏樹\n\n### [「声あり同僚」の人数が少ない、声ありアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&sort=cvColleagueCount%2520asc)\n* 2人: 脇山珠美\n* 3人: 水本ゆかり\n* 5人: 松永涼\n* 6人: 及川雫、上条春菜、難波笑美、木村夏樹、浜口あやめ\n* 7人: 森久保乃々、佐藤心\n\n### ひとこと\nアニメでボイスついたキャラが多いですね。見るからに。\n\nただし、このデータは注意点が多いです。まずデレステ公式が曲イベでユニット名をつけなかったため、珠美・ゆかり・雫の同僚数が少なめになっています。更にしゅがは・森久保のデレステ登場分が加算されていないので値にズレがあります。頑張って脳内で補正してください。\n\nそういう前提のもとで本題に戻りますと、珠美の声あり同僚としてカウントされているのは浜口あやめ・大槻唯です。これは「声ありと絡んだから声がついた」とは言えませんね。更に一人一人見て行くと「声あり同僚はほとんどアニメボイス勢で、デレステ曲で一気に4人増えた」みたいなパターンが多いです。\n\nどうしてこういう事になるかというと、まったく身も蓋もない話ではあるんですけれども、「**既存のボイスあり人気キャラのイベントスケジュールが空いておらず、もはや人間関係を増やせない**」という理路かなと…\n\n以下のデータを見てください。\n\n### [「声あり同僚」の割合が大きい、声ありアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&sort=cvColleagueRate%2520desc)\n* 100%: 小日向美穂、渋谷凛\n* 90%以上: アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく\n\n特に「声あり」との関係が強いベスト7の方々です。「声ありと声ありを絡ませやすい」とすれば、新規ボイス勢もこの7人と関係を持っていそうなものです。\n\nちなみに、[この7人の同僚数は平均23.57人](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F)です。これを単純に7倍すると170弱です。もしかして、この7人だけでシンデレラガールズのほぼ全てをカバーしているんでしょうか？ そうでなくても、声あり勢を俯瞰することができるのでしょうか？\n\nはい、御察しの通りです。答えはノーです。\n\n### [小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル (54人)](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F)\n\n* 安部菜々、五十嵐響子、緒方智絵里、輿水幸子、小早川紗枝、小日向美穂、西園寺琴歌、佐久間まゆ、櫻井桃華、島村卯月、道明寺歌鈴、中野有香、双葉杏、前川みく、三村かな子、宮本フレデリカ、アナスタシア、神谷奈緒、川島瑞樹、神崎蘭子、鷺沢文香、塩見周子、渋谷凛、白坂小梅、高垣楓、鷹富士茄子、高峯のあ、多田李衣菜、橘ありす、新田美波、二宮飛鳥、速水奏、北条加蓮、松本沙理奈、八神マキノ、大和亜季、相葉夕美、赤城みりあ、市原仁奈、大槻唯、佐藤心、城ヶ崎美嘉、城ヶ崎莉嘉、高森藍子、十時愛梨、日野茜、姫川友紀、星輝子、堀裕子、本田未央、的場梨沙、向井拓海、諸星きらり、依田芳乃\n\n平均値が23.5人といっても、7 * 23.5人の同僚がいる訳ではありません。実際に集めてみると54人しかいませんね。\n\nところで、この同僚一覧には気になる部分があるのですが… ちょっと分かりにくいですか？ ではこちらをどうぞ。\n\n### [声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル (48人)](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue%2520AND%2520%28colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F%29&sort=name)\n* 相葉夕美、赤城みりあ、アナスタシア、安部菜々、五十嵐響子、市原仁奈、大槻唯、緒方智絵里、神谷奈緒、川島瑞樹、神崎蘭子、輿水幸子、小早川紗枝、小日向美穂、鷺沢文香、佐久間まゆ、櫻井桃華、佐藤心、塩見周子、渋谷凛、島村卯月、白坂小梅、城ヶ崎美嘉、城ヶ崎莉嘉、高垣楓、高森藍子、多田李衣菜、橘ありす、十時愛梨、道明寺歌鈴、中野有香、新田美波、二宮飛鳥、速水奏、日野茜、姫川友紀、双葉杏、北条加蓮、星輝子、堀裕子、本田未央、前川みく、三村かな子、宮本フレデリカ、向井拓海、諸星きらり、大和亜季、依田芳乃\n\n### [声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル (17人)](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue%2520NOT%2520%28colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F%29&sort=name)\n* 一ノ瀬志希、上田鈴帆、及川雫、片桐早苗、上条春菜、木村夏樹、佐々木千枝、椎名法子、難波笑美、浜口あやめ、藤本里奈、松永涼、水本ゆかり、三船美優、森久保乃々、龍崎薫、脇山珠美\n\n直感的な判断なので断定を避けますが、**総選挙を経由した場合と、アニメでサプライズ追加された場合とで、人間関係の傾向が全く異なっている**ように見えます。","source":"_posts/20170221.md","raw":"---\ntitle: あなたの担当ボイスはどこから？ 私は声あり同僚から！ シンデレラガールズをデータ分析で丸裸にしよう \ndescription: CG総合データベース構築プロジェクト \"hinapedia\" 成果物\npermalink: 1\ndate: 2017-02-21 21:09:08\ntags:\n---\n\n「声なしアイドルって…」\n\n「ボイスの有無はもしかして…」\n\nそんなモヤモヤに今日こそオサラバ！ モバPの疑問にデータで答えます。\n\nこの高度情報化社会では何をするにもデータは不可欠… Pなら担当の統計情報を知ってて当然だよね！\n\nこの投稿は、自由で公平でオープンソースで現在製造中、シンデレラガールズ総合データベース \"[hinapedia](https://tottokotkd.gitlab.io/hinapedia/)\" 最新入力データに基づいています。疑問・提案・修正は [@tottokotkd](https://twitter.com/tottokotkd) まで。\n\ngitlabに詳しい方は直接issueを立てることもできます。詳しくは[ここ](https://tottokotkd.gitlab.io/hinapedia/info/)。\n\n---\n\n## 前提 (絶対ここから読めよ☆)\n\n### 収録データについて\n\n\"hinapedia\" が収録する「ユニット」データとは、大雑把にまとめると以下2つの条件を満たすもの全てです。だいたい2017年1月あたりまで入っています。\n\n* 公式が名前をつけている\n* 劇中劇 (モバマス公演) 由来ではない\n\n公演由来のデータが入っていないのは、端的に言えば「扱いが難しいから」です。以下のデータを見るときには「**まあそうは言っても公演でめっちゃ共演してるしな…**」とか「**このデータはちょっと古いしな…**」とか何とか、脳内でよしなに補正してください。\n\nまた現在の仕様上、例えば「ユニット16」と「Age16」は別々のユニットとして登録されています。つまり**細かい値はあんまり精確じゃない**ので重視せず、大雑把な全体的傾向を掴む方がいいです。「やったー誰それは1ポイント差で3位だー」とか言ってもあんまり意味ないかもしれません。何卒、何卒。\n\n\n### データの見方\n\nとりあえず最初にデータの読み方を確認しましょう。[リンクをクリックすると簡単に現物をチェックできる](https://tottokotkd.gitlab.io/hinapedia/#/idol)ので確かめてみてね。\n\n{% asset_img 0.png %}\n\n表のデータは左から順番に「属性、名前、年齢、身長、所属ユニット数、同僚アイドル人数 (重複なし) 、ボイスあり同僚アイドル人数 (重複なし) 、ボイスあり同僚アイドルの割合、参考リンク」となっています。表の上にあるのはフィルター・ソートの入力欄です。\n\n「重複なし」というのは、同じキャラを何回もカウントしないってことです。たとえば凛の同僚が卯月だらけになってしまっては困りますからね (そういう同人ありそうだけど) 。\n\n実はこの表がなかなかの力作で、クリックでソートできたりコピペできたりする凄いやつなんですけど… 関係ないですね、はい。\n\nでは早速データを眺めてモヤモヤを\u0010叩き潰していきましょう！ 以下全ての項目において、データのタイトルをクリックするとソースが出てきます。この機能もなかなか凄くて… あっ興味ないですね、はい。\n\n---\n\n## 声あり・声なしをデータで観察してみる\n日頃なんとなく気になっていたアレについて確かめてみよう！\n\n### モヤモヤ1. 声なしと声ありの絡みが少ない気がする\n \n**その通り。声ありの同僚は声ありが多く、声なしの同僚は声なしが多い。**人数も割合もそうである。\n\n#### [全体の平均値](https://tottokotkd.gitlab.io/hinapedia/#/idol)\n* 同僚19.41人\n* そのうち声あり同僚8.51人 (39.77%)\n\n#### [声あり](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue)\n* 同僚23.95人\n* そのうち声あり同僚15.69人 **(64.73%)**\n\n#### [声なし](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Afalse)\n\n* 同僚16.91人\n* そのうち声あり同僚4.55人 **(26.03%)**\n\n### ひとこと\nそもそも声なしは所属ユニット数が少ないので、同僚の合計人数が少ないのは仕方ないところ。でも割合まで低いのは注目すべきポイントですね。\n\n---\n\n## モヤモヤ2. 担当のユニット数が少ない or 多い気がする\n\n**事実かもしれない。ユニット所属数には差がある。**\n\n### [ユニット所属数が少ないアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?sort=unitCount%2520asc)\n\n* 4ユニット: 赤西瑛梨華、大石泉\n* 5ユニット: 安斎都、井村雪菜、岸部彩華、工藤忍、西川保奈美\n* 6ユニット: 伊集院惠、大西由里子、桐生つかさ、小松伊吹、土屋亜子、長富蓮実、松永涼、松原早耶\n* 7ユニット: 大原みちる、村松さくら、柳清良、水木聖來、水野翠、脇山珠美、愛野渚、南条光\n* 8ユニット: (多いため略。ソース参照)\n\n\n### [ユニット所属数が多いアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?sort=unitCount%2520desc)\n\n* 20ユニット: 片桐早苗、白坂小梅\n* 19ユニット: 高垣楓\n* 18ユニット: 大槻唯、櫻井桃華\n* 17ユニット: 市原仁奈、緒方智絵里、川島瑞樹、新田美波、姫川友紀、藤原肇、星輝子、堀裕子、龍崎薫\n* 16ユニット: 安部菜々、高橋礼子、ナターリア、宮本フレデリカ、向井拓海\n\n### ひとこと\nもしかすると「ユニット数が少ない＝不遇」という解釈をするかもしれませんが、「イベントに既存ユニットとして登場する機会が多いため、他のユニットが少ない」という解釈もあります。ニューウェーブとか。\n\nユニット数が多いとサプライズ的にボイスつけやすいのかな？\n\n## モヤモヤ3. 声ありと絡まないと声はつかない気がする\n\n**そんなことはない。ただキャラクターの人間関係が固定化されているだけである。**\n\n### [「声あり同僚」の割合が少ない、声ありアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&sort=cvColleagueRate%2520asc)\n* 20%以下: 脇山珠美\n* 30%以下: 水本ゆかり、及川雫、龍崎薫\n* 40%以下: 佐々木千枝、上条春菜、森久保乃々、難波笑美、上田鈴帆、木村夏樹\n\n### [「声あり同僚」の人数が少ない、声ありアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&sort=cvColleagueCount%2520asc)\n* 2人: 脇山珠美\n* 3人: 水本ゆかり\n* 5人: 松永涼\n* 6人: 及川雫、上条春菜、難波笑美、木村夏樹、浜口あやめ\n* 7人: 森久保乃々、佐藤心\n\n### ひとこと\nアニメでボイスついたキャラが多いですね。見るからに。\n\nただし、このデータは注意点が多いです。まずデレステ公式が曲イベでユニット名をつけなかったため、珠美・ゆかり・雫の同僚数が少なめになっています。更にしゅがは・森久保のデレステ登場分が加算されていないので値にズレがあります。頑張って脳内で補正してください。\n\nそういう前提のもとで本題に戻りますと、珠美の声あり同僚としてカウントされているのは浜口あやめ・大槻唯です。これは「声ありと絡んだから声がついた」とは言えませんね。更に一人一人見て行くと「声あり同僚はほとんどアニメボイス勢で、デレステ曲で一気に4人増えた」みたいなパターンが多いです。\n\nどうしてこういう事になるかというと、まったく身も蓋もない話ではあるんですけれども、「**既存のボイスあり人気キャラのイベントスケジュールが空いておらず、もはや人間関係を増やせない**」という理路かなと…\n\n以下のデータを見てください。\n\n### [「声あり同僚」の割合が大きい、声ありアイドル](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&sort=cvColleagueRate%2520desc)\n* 100%: 小日向美穂、渋谷凛\n* 90%以上: アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく\n\n特に「声あり」との関係が強いベスト7の方々です。「声ありと声ありを絡ませやすい」とすれば、新規ボイス勢もこの7人と関係を持っていそうなものです。\n\nちなみに、[この7人の同僚数は平均23.57人](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F)です。これを単純に7倍すると170弱です。もしかして、この7人だけでシンデレラガールズのほぼ全てをカバーしているんでしょうか？ そうでなくても、声あり勢を俯瞰することができるのでしょうか？\n\nはい、御察しの通りです。答えはノーです。\n\n### [小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル (54人)](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F)\n\n* 安部菜々、五十嵐響子、緒方智絵里、輿水幸子、小早川紗枝、小日向美穂、西園寺琴歌、佐久間まゆ、櫻井桃華、島村卯月、道明寺歌鈴、中野有香、双葉杏、前川みく、三村かな子、宮本フレデリカ、アナスタシア、神谷奈緒、川島瑞樹、神崎蘭子、鷺沢文香、塩見周子、渋谷凛、白坂小梅、高垣楓、鷹富士茄子、高峯のあ、多田李衣菜、橘ありす、新田美波、二宮飛鳥、速水奏、北条加蓮、松本沙理奈、八神マキノ、大和亜季、相葉夕美、赤城みりあ、市原仁奈、大槻唯、佐藤心、城ヶ崎美嘉、城ヶ崎莉嘉、高森藍子、十時愛梨、日野茜、姫川友紀、星輝子、堀裕子、本田未央、的場梨沙、向井拓海、諸星きらり、依田芳乃\n\n平均値が23.5人といっても、7 * 23.5人の同僚がいる訳ではありません。実際に集めてみると54人しかいませんね。\n\nところで、この同僚一覧には気になる部分があるのですが… ちょっと分かりにくいですか？ ではこちらをどうぞ。\n\n### [声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル (48人)](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue%2520AND%2520%28colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F%29&sort=name)\n* 相葉夕美、赤城みりあ、アナスタシア、安部菜々、五十嵐響子、市原仁奈、大槻唯、緒方智絵里、神谷奈緒、川島瑞樹、神崎蘭子、輿水幸子、小早川紗枝、小日向美穂、鷺沢文香、佐久間まゆ、櫻井桃華、佐藤心、塩見周子、渋谷凛、島村卯月、白坂小梅、城ヶ崎美嘉、城ヶ崎莉嘉、高垣楓、高森藍子、多田李衣菜、橘ありす、十時愛梨、道明寺歌鈴、中野有香、新田美波、二宮飛鳥、速水奏、日野茜、姫川友紀、双葉杏、北条加蓮、星輝子、堀裕子、本田未央、前川みく、三村かな子、宮本フレデリカ、向井拓海、諸星きらり、大和亜季、依田芳乃\n\n### [声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル (17人)](https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue%2520NOT%2520%28colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F%29&sort=name)\n* 一ノ瀬志希、上田鈴帆、及川雫、片桐早苗、上条春菜、木村夏樹、佐々木千枝、椎名法子、難波笑美、浜口あやめ、藤本里奈、松永涼、水本ゆかり、三船美優、森久保乃々、龍崎薫、脇山珠美\n\n直感的な判断なので断定を避けますが、**総選挙を経由した場合と、アニメでサプライズ追加された場合とで、人間関係の傾向が全く異なっている**ように見えます。","slug":"1","published":1,"updated":"2017-02-22T02:03:14.000Z","_id":"cizfk5co8000athc1402nidec","comments":1,"layout":"post","photos":[],"link":"","content":"<p>「声なしアイドルって…」</p>\n<p>「ボイスの有無はもしかして…」</p>\n<p>そんなモヤモヤに今日こそオサラバ！ モバPの疑問にデータで答えます。</p>\n<p>この高度情報化社会では何をするにもデータは不可欠… Pなら担当の統計情報を知ってて当然だよね！</p>\n<p>この投稿は、自由で公平でオープンソースで現在製造中、シンデレラガールズ総合データベース “<a href=\"https://tottokotkd.gitlab.io/hinapedia/\" target=\"_blank\" rel=\"external\">hinapedia</a>“ 最新入力データに基づいています。疑問・提案・修正は <a href=\"https://twitter.com/tottokotkd\" target=\"_blank\" rel=\"external\">@tottokotkd</a> まで。</p>\n<p>gitlabに詳しい方は直接issueを立てることもできます。詳しくは<a href=\"https://tottokotkd.gitlab.io/hinapedia/info/\" target=\"_blank\" rel=\"external\">ここ</a>。</p>\n<hr>\n<h2 id=\"前提-絶対ここから読めよ☆\"><a href=\"#前提-絶対ここから読めよ☆\" class=\"headerlink\" title=\"前提 (絶対ここから読めよ☆)\"></a>前提 (絶対ここから読めよ☆)</h2><h3 id=\"収録データについて\"><a href=\"#収録データについて\" class=\"headerlink\" title=\"収録データについて\"></a>収録データについて</h3><p>“hinapedia” が収録する「ユニット」データとは、大雑把にまとめると以下2つの条件を満たすもの全てです。だいたい2017年1月あたりまで入っています。</p>\n<ul>\n<li>公式が名前をつけている</li>\n<li>劇中劇 (モバマス公演) 由来ではない</li>\n</ul>\n<p>公演由来のデータが入っていないのは、端的に言えば「扱いが難しいから」です。以下のデータを見るときには「<strong>まあそうは言っても公演でめっちゃ共演してるしな…</strong>」とか「<strong>このデータはちょっと古いしな…</strong>」とか何とか、脳内でよしなに補正してください。</p>\n<p>また現在の仕様上、例えば「ユニット16」と「Age16」は別々のユニットとして登録されています。つまり<strong>細かい値はあんまり精確じゃない</strong>ので重視せず、大雑把な全体的傾向を掴む方がいいです。「やったー誰それは1ポイント差で3位だー」とか言ってもあんまり意味ないかもしれません。何卒、何卒。</p>\n<h3 id=\"データの見方\"><a href=\"#データの見方\" class=\"headerlink\" title=\"データの見方\"></a>データの見方</h3><p>とりあえず最初にデータの読み方を確認しましょう。<a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol\" target=\"_blank\" rel=\"external\">リンクをクリックすると簡単に現物をチェックできる</a>ので確かめてみてね。</p>\n<img src=\"/2017/02/21/1/0.png\" alt=\"0.png\" title=\"\">\n<p>表のデータは左から順番に「属性、名前、年齢、身長、所属ユニット数、同僚アイドル人数 (重複なし) 、ボイスあり同僚アイドル人数 (重複なし) 、ボイスあり同僚アイドルの割合、参考リンク」となっています。表の上にあるのはフィルター・ソートの入力欄です。</p>\n<p>「重複なし」というのは、同じキャラを何回もカウントしないってことです。たとえば凛の同僚が卯月だらけになってしまっては困りますからね (そういう同人ありそうだけど) 。</p>\n<p>実はこの表がなかなかの力作で、クリックでソートできたりコピペできたりする凄いやつなんですけど… 関係ないですね、はい。</p>\n<p>では早速データを眺めてモヤモヤを\u0010叩き潰していきましょう！ 以下全ての項目において、データのタイトルをクリックするとソースが出てきます。この機能もなかなか凄くて… あっ興味ないですね、はい。</p>\n<hr>\n<h2 id=\"声あり・声なしをデータで観察してみる\"><a href=\"#声あり・声なしをデータで観察してみる\" class=\"headerlink\" title=\"声あり・声なしをデータで観察してみる\"></a>声あり・声なしをデータで観察してみる</h2><p>日頃なんとなく気になっていたアレについて確かめてみよう！</p>\n<h3 id=\"モヤモヤ1-声なしと声ありの絡みが少ない気がする\"><a href=\"#モヤモヤ1-声なしと声ありの絡みが少ない気がする\" class=\"headerlink\" title=\"モヤモヤ1. 声なしと声ありの絡みが少ない気がする\"></a>モヤモヤ1. 声なしと声ありの絡みが少ない気がする</h3><p><strong>その通り。声ありの同僚は声ありが多く、声なしの同僚は声なしが多い。</strong>人数も割合もそうである。</p>\n<h4 id=\"全体の平均値\"><a href=\"#全体の平均値\" class=\"headerlink\" title=\"全体の平均値\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol\" target=\"_blank\" rel=\"external\">全体の平均値</a></h4><ul>\n<li>同僚19.41人</li>\n<li>そのうち声あり同僚8.51人 (39.77%)</li>\n</ul>\n<h4 id=\"声あり\"><a href=\"#声あり\" class=\"headerlink\" title=\"声あり\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue\" target=\"_blank\" rel=\"external\">声あり</a></h4><ul>\n<li>同僚23.95人</li>\n<li>そのうち声あり同僚15.69人 <strong>(64.73%)</strong></li>\n</ul>\n<h4 id=\"声なし\"><a href=\"#声なし\" class=\"headerlink\" title=\"声なし\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Afalse\" target=\"_blank\" rel=\"external\">声なし</a></h4><ul>\n<li>同僚16.91人</li>\n<li>そのうち声あり同僚4.55人 <strong>(26.03%)</strong></li>\n</ul>\n<h3 id=\"ひとこと\"><a href=\"#ひとこと\" class=\"headerlink\" title=\"ひとこと\"></a>ひとこと</h3><p>そもそも声なしは所属ユニット数が少ないので、同僚の合計人数が少ないのは仕方ないところ。でも割合まで低いのは注目すべきポイントですね。</p>\n<hr>\n<h2 id=\"モヤモヤ2-担当のユニット数が少ない-or-多い気がする\"><a href=\"#モヤモヤ2-担当のユニット数が少ない-or-多い気がする\" class=\"headerlink\" title=\"モヤモヤ2. 担当のユニット数が少ない or 多い気がする\"></a>モヤモヤ2. 担当のユニット数が少ない or 多い気がする</h2><p><strong>事実かもしれない。ユニット所属数には差がある。</strong></p>\n<h3 id=\"ユニット所属数が少ないアイドル\"><a href=\"#ユニット所属数が少ないアイドル\" class=\"headerlink\" title=\"ユニット所属数が少ないアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?sort=unitCount%2520asc\" target=\"_blank\" rel=\"external\">ユニット所属数が少ないアイドル</a></h3><ul>\n<li>4ユニット: 赤西瑛梨華、大石泉</li>\n<li>5ユニット: 安斎都、井村雪菜、岸部彩華、工藤忍、西川保奈美</li>\n<li>6ユニット: 伊集院惠、大西由里子、桐生つかさ、小松伊吹、土屋亜子、長富蓮実、松永涼、松原早耶</li>\n<li>7ユニット: 大原みちる、村松さくら、柳清良、水木聖來、水野翠、脇山珠美、愛野渚、南条光</li>\n<li>8ユニット: (多いため略。ソース参照)</li>\n</ul>\n<h3 id=\"ユニット所属数が多いアイドル\"><a href=\"#ユニット所属数が多いアイドル\" class=\"headerlink\" title=\"ユニット所属数が多いアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?sort=unitCount%2520desc\" target=\"_blank\" rel=\"external\">ユニット所属数が多いアイドル</a></h3><ul>\n<li>20ユニット: 片桐早苗、白坂小梅</li>\n<li>19ユニット: 高垣楓</li>\n<li>18ユニット: 大槻唯、櫻井桃華</li>\n<li>17ユニット: 市原仁奈、緒方智絵里、川島瑞樹、新田美波、姫川友紀、藤原肇、星輝子、堀裕子、龍崎薫</li>\n<li>16ユニット: 安部菜々、高橋礼子、ナターリア、宮本フレデリカ、向井拓海</li>\n</ul>\n<h3 id=\"ひとこと-1\"><a href=\"#ひとこと-1\" class=\"headerlink\" title=\"ひとこと\"></a>ひとこと</h3><p>もしかすると「ユニット数が少ない＝不遇」という解釈をするかもしれませんが、「イベントに既存ユニットとして登場する機会が多いため、他のユニットが少ない」という解釈もあります。ニューウェーブとか。</p>\n<p>ユニット数が多いとサプライズ的にボイスつけやすいのかな？</p>\n<h2 id=\"モヤモヤ3-声ありと絡まないと声はつかない気がする\"><a href=\"#モヤモヤ3-声ありと絡まないと声はつかない気がする\" class=\"headerlink\" title=\"モヤモヤ3. 声ありと絡まないと声はつかない気がする\"></a>モヤモヤ3. 声ありと絡まないと声はつかない気がする</h2><p><strong>そんなことはない。ただキャラクターの人間関係が固定化されているだけである。</strong></p>\n<h3 id=\"「声あり同僚」の割合が少ない、声ありアイドル\"><a href=\"#「声あり同僚」の割合が少ない、声ありアイドル\" class=\"headerlink\" title=\"「声あり同僚」の割合が少ない、声ありアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&amp;sort=cvColleagueRate%2520asc\" target=\"_blank\" rel=\"external\">「声あり同僚」の割合が少ない、声ありアイドル</a></h3><ul>\n<li>20%以下: 脇山珠美</li>\n<li>30%以下: 水本ゆかり、及川雫、龍崎薫</li>\n<li>40%以下: 佐々木千枝、上条春菜、森久保乃々、難波笑美、上田鈴帆、木村夏樹</li>\n</ul>\n<h3 id=\"「声あり同僚」の人数が少ない、声ありアイドル\"><a href=\"#「声あり同僚」の人数が少ない、声ありアイドル\" class=\"headerlink\" title=\"「声あり同僚」の人数が少ない、声ありアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&amp;sort=cvColleagueCount%2520asc\" target=\"_blank\" rel=\"external\">「声あり同僚」の人数が少ない、声ありアイドル</a></h3><ul>\n<li>2人: 脇山珠美</li>\n<li>3人: 水本ゆかり</li>\n<li>5人: 松永涼</li>\n<li>6人: 及川雫、上条春菜、難波笑美、木村夏樹、浜口あやめ</li>\n<li>7人: 森久保乃々、佐藤心</li>\n</ul>\n<h3 id=\"ひとこと-2\"><a href=\"#ひとこと-2\" class=\"headerlink\" title=\"ひとこと\"></a>ひとこと</h3><p>アニメでボイスついたキャラが多いですね。見るからに。</p>\n<p>ただし、このデータは注意点が多いです。まずデレステ公式が曲イベでユニット名をつけなかったため、珠美・ゆかり・雫の同僚数が少なめになっています。更にしゅがは・森久保のデレステ登場分が加算されていないので値にズレがあります。頑張って脳内で補正してください。</p>\n<p>そういう前提のもとで本題に戻りますと、珠美の声あり同僚としてカウントされているのは浜口あやめ・大槻唯です。これは「声ありと絡んだから声がついた」とは言えませんね。更に一人一人見て行くと「声あり同僚はほとんどアニメボイス勢で、デレステ曲で一気に4人増えた」みたいなパターンが多いです。</p>\n<p>どうしてこういう事になるかというと、まったく身も蓋もない話ではあるんですけれども、「<strong>既存のボイスあり人気キャラのイベントスケジュールが空いておらず、もはや人間関係を増やせない</strong>」という理路かなと…</p>\n<p>以下のデータを見てください。</p>\n<h3 id=\"「声あり同僚」の割合が大きい、声ありアイドル\"><a href=\"#「声あり同僚」の割合が大きい、声ありアイドル\" class=\"headerlink\" title=\"「声あり同僚」の割合が大きい、声ありアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&amp;sort=cvColleagueRate%2520desc\" target=\"_blank\" rel=\"external\">「声あり同僚」の割合が大きい、声ありアイドル</a></h3><ul>\n<li>100%: 小日向美穂、渋谷凛</li>\n<li>90%以上: アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく</li>\n</ul>\n<p>特に「声あり」との関係が強いベスト7の方々です。「声ありと声ありを絡ませやすい」とすれば、新規ボイス勢もこの7人と関係を持っていそうなものです。</p>\n<p>ちなみに、<a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F\" target=\"_blank\" rel=\"external\">この7人の同僚数は平均23.57人</a>です。これを単純に7倍すると170弱です。もしかして、この7人だけでシンデレラガールズのほぼ全てをカバーしているんでしょうか？ そうでなくても、声あり勢を俯瞰することができるのでしょうか？</p>\n<p>はい、御察しの通りです。答えはノーです。</p>\n<h3 id=\"小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル-54人\"><a href=\"#小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル-54人\" class=\"headerlink\" title=\"小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル (54人)\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F\" target=\"_blank\" rel=\"external\">小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル (54人)</a></h3><ul>\n<li>安部菜々、五十嵐響子、緒方智絵里、輿水幸子、小早川紗枝、小日向美穂、西園寺琴歌、佐久間まゆ、櫻井桃華、島村卯月、道明寺歌鈴、中野有香、双葉杏、前川みく、三村かな子、宮本フレデリカ、アナスタシア、神谷奈緒、川島瑞樹、神崎蘭子、鷺沢文香、塩見周子、渋谷凛、白坂小梅、高垣楓、鷹富士茄子、高峯のあ、多田李衣菜、橘ありす、新田美波、二宮飛鳥、速水奏、北条加蓮、松本沙理奈、八神マキノ、大和亜季、相葉夕美、赤城みりあ、市原仁奈、大槻唯、佐藤心、城ヶ崎美嘉、城ヶ崎莉嘉、高森藍子、十時愛梨、日野茜、姫川友紀、星輝子、堀裕子、本田未央、的場梨沙、向井拓海、諸星きらり、依田芳乃</li>\n</ul>\n<p>平均値が23.5人といっても、7 * 23.5人の同僚がいる訳ではありません。実際に集めてみると54人しかいませんね。</p>\n<p>ところで、この同僚一覧には気になる部分があるのですが… ちょっと分かりにくいですか？ ではこちらをどうぞ。</p>\n<h3 id=\"声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル-48人\"><a href=\"#声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル-48人\" class=\"headerlink\" title=\"声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル (48人)\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue%2520AND%2520%28colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F%29&amp;sort=name\" target=\"_blank\" rel=\"external\">声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル (48人)</a></h3><ul>\n<li>相葉夕美、赤城みりあ、アナスタシア、安部菜々、五十嵐響子、市原仁奈、大槻唯、緒方智絵里、神谷奈緒、川島瑞樹、神崎蘭子、輿水幸子、小早川紗枝、小日向美穂、鷺沢文香、佐久間まゆ、櫻井桃華、佐藤心、塩見周子、渋谷凛、島村卯月、白坂小梅、城ヶ崎美嘉、城ヶ崎莉嘉、高垣楓、高森藍子、多田李衣菜、橘ありす、十時愛梨、道明寺歌鈴、中野有香、新田美波、二宮飛鳥、速水奏、日野茜、姫川友紀、双葉杏、北条加蓮、星輝子、堀裕子、本田未央、前川みく、三村かな子、宮本フレデリカ、向井拓海、諸星きらり、大和亜季、依田芳乃</li>\n</ul>\n<h3 id=\"声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル-17人\"><a href=\"#声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル-17人\" class=\"headerlink\" title=\"声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル (17人)\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue%2520NOT%2520%28colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F%29&amp;sort=name\" target=\"_blank\" rel=\"external\">声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル (17人)</a></h3><ul>\n<li>一ノ瀬志希、上田鈴帆、及川雫、片桐早苗、上条春菜、木村夏樹、佐々木千枝、椎名法子、難波笑美、浜口あやめ、藤本里奈、松永涼、水本ゆかり、三船美優、森久保乃々、龍崎薫、脇山珠美</li>\n</ul>\n<p>直感的な判断なので断定を避けますが、<strong>総選挙を経由した場合と、アニメでサプライズ追加された場合とで、人間関係の傾向が全く異なっている</strong>ように見えます。</p>\n","excerpt":"","more":"<p>「声なしアイドルって…」</p>\n<p>「ボイスの有無はもしかして…」</p>\n<p>そんなモヤモヤに今日こそオサラバ！ モバPの疑問にデータで答えます。</p>\n<p>この高度情報化社会では何をするにもデータは不可欠… Pなら担当の統計情報を知ってて当然だよね！</p>\n<p>この投稿は、自由で公平でオープンソースで現在製造中、シンデレラガールズ総合データベース “<a href=\"https://tottokotkd.gitlab.io/hinapedia/\">hinapedia</a>“ 最新入力データに基づいています。疑問・提案・修正は <a href=\"https://twitter.com/tottokotkd\">@tottokotkd</a> まで。</p>\n<p>gitlabに詳しい方は直接issueを立てることもできます。詳しくは<a href=\"https://tottokotkd.gitlab.io/hinapedia/info/\">ここ</a>。</p>\n<hr>\n<h2 id=\"前提-絶対ここから読めよ☆\"><a href=\"#前提-絶対ここから読めよ☆\" class=\"headerlink\" title=\"前提 (絶対ここから読めよ☆)\"></a>前提 (絶対ここから読めよ☆)</h2><h3 id=\"収録データについて\"><a href=\"#収録データについて\" class=\"headerlink\" title=\"収録データについて\"></a>収録データについて</h3><p>“hinapedia” が収録する「ユニット」データとは、大雑把にまとめると以下2つの条件を満たすもの全てです。だいたい2017年1月あたりまで入っています。</p>\n<ul>\n<li>公式が名前をつけている</li>\n<li>劇中劇 (モバマス公演) 由来ではない</li>\n</ul>\n<p>公演由来のデータが入っていないのは、端的に言えば「扱いが難しいから」です。以下のデータを見るときには「<strong>まあそうは言っても公演でめっちゃ共演してるしな…</strong>」とか「<strong>このデータはちょっと古いしな…</strong>」とか何とか、脳内でよしなに補正してください。</p>\n<p>また現在の仕様上、例えば「ユニット16」と「Age16」は別々のユニットとして登録されています。つまり<strong>細かい値はあんまり精確じゃない</strong>ので重視せず、大雑把な全体的傾向を掴む方がいいです。「やったー誰それは1ポイント差で3位だー」とか言ってもあんまり意味ないかもしれません。何卒、何卒。</p>\n<h3 id=\"データの見方\"><a href=\"#データの見方\" class=\"headerlink\" title=\"データの見方\"></a>データの見方</h3><p>とりあえず最初にデータの読み方を確認しましょう。<a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol\">リンクをクリックすると簡単に現物をチェックできる</a>ので確かめてみてね。</p>\n<img src=\"/2017/02/21/1/0.png\" alt=\"0.png\" title=\"\">\n<p>表のデータは左から順番に「属性、名前、年齢、身長、所属ユニット数、同僚アイドル人数 (重複なし) 、ボイスあり同僚アイドル人数 (重複なし) 、ボイスあり同僚アイドルの割合、参考リンク」となっています。表の上にあるのはフィルター・ソートの入力欄です。</p>\n<p>「重複なし」というのは、同じキャラを何回もカウントしないってことです。たとえば凛の同僚が卯月だらけになってしまっては困りますからね (そういう同人ありそうだけど) 。</p>\n<p>実はこの表がなかなかの力作で、クリックでソートできたりコピペできたりする凄いやつなんですけど… 関係ないですね、はい。</p>\n<p>では早速データを眺めてモヤモヤを\u0010叩き潰していきましょう！ 以下全ての項目において、データのタイトルをクリックするとソースが出てきます。この機能もなかなか凄くて… あっ興味ないですね、はい。</p>\n<hr>\n<h2 id=\"声あり・声なしをデータで観察してみる\"><a href=\"#声あり・声なしをデータで観察してみる\" class=\"headerlink\" title=\"声あり・声なしをデータで観察してみる\"></a>声あり・声なしをデータで観察してみる</h2><p>日頃なんとなく気になっていたアレについて確かめてみよう！</p>\n<h3 id=\"モヤモヤ1-声なしと声ありの絡みが少ない気がする\"><a href=\"#モヤモヤ1-声なしと声ありの絡みが少ない気がする\" class=\"headerlink\" title=\"モヤモヤ1. 声なしと声ありの絡みが少ない気がする\"></a>モヤモヤ1. 声なしと声ありの絡みが少ない気がする</h3><p><strong>その通り。声ありの同僚は声ありが多く、声なしの同僚は声なしが多い。</strong>人数も割合もそうである。</p>\n<h4 id=\"全体の平均値\"><a href=\"#全体の平均値\" class=\"headerlink\" title=\"全体の平均値\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol\">全体の平均値</a></h4><ul>\n<li>同僚19.41人</li>\n<li>そのうち声あり同僚8.51人 (39.77%)</li>\n</ul>\n<h4 id=\"声あり\"><a href=\"#声あり\" class=\"headerlink\" title=\"声あり\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue\">声あり</a></h4><ul>\n<li>同僚23.95人</li>\n<li>そのうち声あり同僚15.69人 <strong>(64.73%)</strong></li>\n</ul>\n<h4 id=\"声なし\"><a href=\"#声なし\" class=\"headerlink\" title=\"声なし\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Afalse\">声なし</a></h4><ul>\n<li>同僚16.91人</li>\n<li>そのうち声あり同僚4.55人 <strong>(26.03%)</strong></li>\n</ul>\n<h3 id=\"ひとこと\"><a href=\"#ひとこと\" class=\"headerlink\" title=\"ひとこと\"></a>ひとこと</h3><p>そもそも声なしは所属ユニット数が少ないので、同僚の合計人数が少ないのは仕方ないところ。でも割合まで低いのは注目すべきポイントですね。</p>\n<hr>\n<h2 id=\"モヤモヤ2-担当のユニット数が少ない-or-多い気がする\"><a href=\"#モヤモヤ2-担当のユニット数が少ない-or-多い気がする\" class=\"headerlink\" title=\"モヤモヤ2. 担当のユニット数が少ない or 多い気がする\"></a>モヤモヤ2. 担当のユニット数が少ない or 多い気がする</h2><p><strong>事実かもしれない。ユニット所属数には差がある。</strong></p>\n<h3 id=\"ユニット所属数が少ないアイドル\"><a href=\"#ユニット所属数が少ないアイドル\" class=\"headerlink\" title=\"ユニット所属数が少ないアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?sort=unitCount%2520asc\">ユニット所属数が少ないアイドル</a></h3><ul>\n<li>4ユニット: 赤西瑛梨華、大石泉</li>\n<li>5ユニット: 安斎都、井村雪菜、岸部彩華、工藤忍、西川保奈美</li>\n<li>6ユニット: 伊集院惠、大西由里子、桐生つかさ、小松伊吹、土屋亜子、長富蓮実、松永涼、松原早耶</li>\n<li>7ユニット: 大原みちる、村松さくら、柳清良、水木聖來、水野翠、脇山珠美、愛野渚、南条光</li>\n<li>8ユニット: (多いため略。ソース参照)</li>\n</ul>\n<h3 id=\"ユニット所属数が多いアイドル\"><a href=\"#ユニット所属数が多いアイドル\" class=\"headerlink\" title=\"ユニット所属数が多いアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?sort=unitCount%2520desc\">ユニット所属数が多いアイドル</a></h3><ul>\n<li>20ユニット: 片桐早苗、白坂小梅</li>\n<li>19ユニット: 高垣楓</li>\n<li>18ユニット: 大槻唯、櫻井桃華</li>\n<li>17ユニット: 市原仁奈、緒方智絵里、川島瑞樹、新田美波、姫川友紀、藤原肇、星輝子、堀裕子、龍崎薫</li>\n<li>16ユニット: 安部菜々、高橋礼子、ナターリア、宮本フレデリカ、向井拓海</li>\n</ul>\n<h3 id=\"ひとこと-1\"><a href=\"#ひとこと-1\" class=\"headerlink\" title=\"ひとこと\"></a>ひとこと</h3><p>もしかすると「ユニット数が少ない＝不遇」という解釈をするかもしれませんが、「イベントに既存ユニットとして登場する機会が多いため、他のユニットが少ない」という解釈もあります。ニューウェーブとか。</p>\n<p>ユニット数が多いとサプライズ的にボイスつけやすいのかな？</p>\n<h2 id=\"モヤモヤ3-声ありと絡まないと声はつかない気がする\"><a href=\"#モヤモヤ3-声ありと絡まないと声はつかない気がする\" class=\"headerlink\" title=\"モヤモヤ3. 声ありと絡まないと声はつかない気がする\"></a>モヤモヤ3. 声ありと絡まないと声はつかない気がする</h2><p><strong>そんなことはない。ただキャラクターの人間関係が固定化されているだけである。</strong></p>\n<h3 id=\"「声あり同僚」の割合が少ない、声ありアイドル\"><a href=\"#「声あり同僚」の割合が少ない、声ありアイドル\" class=\"headerlink\" title=\"「声あり同僚」の割合が少ない、声ありアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&amp;sort=cvColleagueRate%2520asc\">「声あり同僚」の割合が少ない、声ありアイドル</a></h3><ul>\n<li>20%以下: 脇山珠美</li>\n<li>30%以下: 水本ゆかり、及川雫、龍崎薫</li>\n<li>40%以下: 佐々木千枝、上条春菜、森久保乃々、難波笑美、上田鈴帆、木村夏樹</li>\n</ul>\n<h3 id=\"「声あり同僚」の人数が少ない、声ありアイドル\"><a href=\"#「声あり同僚」の人数が少ない、声ありアイドル\" class=\"headerlink\" title=\"「声あり同僚」の人数が少ない、声ありアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&amp;sort=cvColleagueCount%2520asc\">「声あり同僚」の人数が少ない、声ありアイドル</a></h3><ul>\n<li>2人: 脇山珠美</li>\n<li>3人: 水本ゆかり</li>\n<li>5人: 松永涼</li>\n<li>6人: 及川雫、上条春菜、難波笑美、木村夏樹、浜口あやめ</li>\n<li>7人: 森久保乃々、佐藤心</li>\n</ul>\n<h3 id=\"ひとこと-2\"><a href=\"#ひとこと-2\" class=\"headerlink\" title=\"ひとこと\"></a>ひとこと</h3><p>アニメでボイスついたキャラが多いですね。見るからに。</p>\n<p>ただし、このデータは注意点が多いです。まずデレステ公式が曲イベでユニット名をつけなかったため、珠美・ゆかり・雫の同僚数が少なめになっています。更にしゅがは・森久保のデレステ登場分が加算されていないので値にズレがあります。頑張って脳内で補正してください。</p>\n<p>そういう前提のもとで本題に戻りますと、珠美の声あり同僚としてカウントされているのは浜口あやめ・大槻唯です。これは「声ありと絡んだから声がついた」とは言えませんね。更に一人一人見て行くと「声あり同僚はほとんどアニメボイス勢で、デレステ曲で一気に4人増えた」みたいなパターンが多いです。</p>\n<p>どうしてこういう事になるかというと、まったく身も蓋もない話ではあるんですけれども、「<strong>既存のボイスあり人気キャラのイベントスケジュールが空いておらず、もはや人間関係を増やせない</strong>」という理路かなと…</p>\n<p>以下のデータを見てください。</p>\n<h3 id=\"「声あり同僚」の割合が大きい、声ありアイドル\"><a href=\"#「声あり同僚」の割合が大きい、声ありアイドル\" class=\"headerlink\" title=\"「声あり同僚」の割合が大きい、声ありアイドル\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue&amp;sort=cvColleagueRate%2520desc\">「声あり同僚」の割合が大きい、声ありアイドル</a></h3><ul>\n<li>100%: 小日向美穂、渋谷凛</li>\n<li>90%以上: アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく</li>\n</ul>\n<p>特に「声あり」との関係が強いベスト7の方々です。「声ありと声ありを絡ませやすい」とすれば、新規ボイス勢もこの7人と関係を持っていそうなものです。</p>\n<p>ちなみに、<a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F\">この7人の同僚数は平均23.57人</a>です。これを単純に7倍すると170弱です。もしかして、この7人だけでシンデレラガールズのほぼ全てをカバーしているんでしょうか？ そうでなくても、声あり勢を俯瞰することができるのでしょうか？</p>\n<p>はい、御察しの通りです。答えはノーです。</p>\n<h3 id=\"小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル-54人\"><a href=\"#小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル-54人\" class=\"headerlink\" title=\"小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル (54人)\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F\">小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みく、いずれかの同僚アイドル (54人)</a></h3><ul>\n<li>安部菜々、五十嵐響子、緒方智絵里、輿水幸子、小早川紗枝、小日向美穂、西園寺琴歌、佐久間まゆ、櫻井桃華、島村卯月、道明寺歌鈴、中野有香、双葉杏、前川みく、三村かな子、宮本フレデリカ、アナスタシア、神谷奈緒、川島瑞樹、神崎蘭子、鷺沢文香、塩見周子、渋谷凛、白坂小梅、高垣楓、鷹富士茄子、高峯のあ、多田李衣菜、橘ありす、新田美波、二宮飛鳥、速水奏、北条加蓮、松本沙理奈、八神マキノ、大和亜季、相葉夕美、赤城みりあ、市原仁奈、大槻唯、佐藤心、城ヶ崎美嘉、城ヶ崎莉嘉、高森藍子、十時愛梨、日野茜、姫川友紀、星輝子、堀裕子、本田未央、的場梨沙、向井拓海、諸星きらり、依田芳乃</li>\n</ul>\n<p>平均値が23.5人といっても、7 * 23.5人の同僚がいる訳ではありません。実際に集めてみると54人しかいませんね。</p>\n<p>ところで、この同僚一覧には気になる部分があるのですが… ちょっと分かりにくいですか？ ではこちらをどうぞ。</p>\n<h3 id=\"声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル-48人\"><a href=\"#声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル-48人\" class=\"headerlink\" title=\"声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル (48人)\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue%2520AND%2520%28colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F%29&amp;sort=name\">声ありで、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくのいずれかと同僚のアイドル (48人)</a></h3><ul>\n<li>相葉夕美、赤城みりあ、アナスタシア、安部菜々、五十嵐響子、市原仁奈、大槻唯、緒方智絵里、神谷奈緒、川島瑞樹、神崎蘭子、輿水幸子、小早川紗枝、小日向美穂、鷺沢文香、佐久間まゆ、櫻井桃華、佐藤心、塩見周子、渋谷凛、島村卯月、白坂小梅、城ヶ崎美嘉、城ヶ崎莉嘉、高垣楓、高森藍子、多田李衣菜、橘ありす、十時愛梨、道明寺歌鈴、中野有香、新田美波、二宮飛鳥、速水奏、日野茜、姫川友紀、双葉杏、北条加蓮、星輝子、堀裕子、本田未央、前川みく、三村かな子、宮本フレデリカ、向井拓海、諸星きらり、大和亜季、依田芳乃</li>\n</ul>\n<h3 id=\"声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル-17人\"><a href=\"#声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル-17人\" class=\"headerlink\" title=\"声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル (17人)\"></a><a href=\"https://tottokotkd.gitlab.io/hinapedia/#/idol?filter=voice%253Atrue%2520NOT%2520%28colleague%253A%25E5%25B0%258F%25E6%2597%25A5%25E5%2590%2591%25E7%25BE%258E%25E7%25A9%2582%2520OR%2520colleague%253A%25E6%25B8%258B%25E8%25B0%25B7%25E5%2587%259B%2520OR%2520colleague%253A%25E3%2582%25A2%25E3%2583%258A%25E3%2582%25B9%25E3%2582%25BF%25E3%2582%25B7%25E3%2582%25A2%2520OR%2520colleague%253A%25E8%25BC%25BF%25E6%25B0%25B4%25E5%25B9%25B8%25E5%25AD%2590%2520OR%2520colleague%253A%25E5%258C%2597%25E6%259D%25A1%25E5%258A%25A0%25E8%2593%25AE%2520OR%2520colleague%253A%25E8%25AB%25B8%25E6%2598%259F%25E3%2581%258D%25E3%2582%2589%25E3%2582%258A%2520OR%2520colleague%253A%25E5%2589%258D%25E5%25B7%259D%25E3%2581%25BF%25E3%2581%258F%29&amp;sort=name\">声ありだが、小日向美穂、渋谷凛、アナスタシア、輿水幸子、北条加蓮、諸星きらり、前川みくの誰とも同僚でないアイドル (17人)</a></h3><ul>\n<li>一ノ瀬志希、上田鈴帆、及川雫、片桐早苗、上条春菜、木村夏樹、佐々木千枝、椎名法子、難波笑美、浜口あやめ、藤本里奈、松永涼、水本ゆかり、三船美優、森久保乃々、龍崎薫、脇山珠美</li>\n</ul>\n<p>直感的な判断なので断定を避けますが、<strong>総選挙を経由した場合と、アニメでサプライズ追加された場合とで、人間関係の傾向が全く異なっている</strong>ように見えます。</p>\n"}],"PostAsset":[{"_id":"source/_posts/20170221/1-1.png","slug":"1-1.png","post":"cizfk5co8000athc1402nidec","modified":1,"renderable":0},{"_id":"source/_posts/20170221/1-2.png","slug":"1-2.png","post":"cizfk5co8000athc1402nidec","modified":1,"renderable":0},{"_id":"source/_posts/20170221/1-3.png","slug":"1-3.png","post":"cizfk5co8000athc1402nidec","modified":1,"renderable":0},{"_id":"source/_posts/20170221/0.png","slug":"0.png","post":"cizfk5co8000athc1402nidec","modified":1,"renderable":0}],"PostCategory":[],"PostTag":[{"post_id":"cizfk5cnh0000thc1x5mvgonq","tag_id":"cizfk5cnv0002thc1khrfy6c3","_id":"cizfk5co30006thc12h2ysgxu"},{"post_id":"cizfk5co10005thc1i1ag1ttg","tag_id":"cizfk5co70008thc1ydedxxhk","_id":"cizfk5coi000fthc1ufe70fuu"},{"post_id":"cizfk5co10005thc1i1ag1ttg","tag_id":"cizfk5coe000bthc1kaaftg0h","_id":"cizfk5coi000gthc1a1l03wub"},{"post_id":"cizfk5co10005thc1i1ag1ttg","tag_id":"cizfk5cof000cthc1m3m3r77f","_id":"cizfk5coi000ithc1chtnulyp"},{"post_id":"cizfk5co10005thc1i1ag1ttg","tag_id":"cizfk5cof000dthc1z0v1zna3","_id":"cizfk5coi000jthc1o20vvg6i"},{"post_id":"cizfk5co30007thc1iuz2hh3m","tag_id":"cizfk5co70008thc1ydedxxhk","_id":"cizfk5coj000mthc1yq8bbxm2"},{"post_id":"cizfk5co30007thc1iuz2hh3m","tag_id":"cizfk5coi000hthc19ynapnjm","_id":"cizfk5cok000nthc19j6n9z5r"},{"post_id":"cizfk5co30007thc1iuz2hh3m","tag_id":"cizfk5coi000kthc1qkmygy4i","_id":"cizfk5cok000pthc1mgm4xhde"},{"post_id":"cizfk5co70009thc1y4885psw","tag_id":"cizfk5coj000lthc1tuhq964d","_id":"cizfk5col000qthc19e2fhoqg"},{"post_id":"cizfk5co70009thc1y4885psw","tag_id":"cizfk5cok000othc1bwyi5so5","_id":"cizfk5col000rthc1td6m9vjy"}],"Tag":[{"name":"Gulp","_id":"cizfk5cnv0002thc1khrfy6c3"},{"name":"Swift","_id":"cizfk5co70008thc1ydedxxhk"},{"name":"Kitura","_id":"cizfk5coe000bthc1kaaftg0h"},{"name":"MariaDB","_id":"cizfk5cof000cthc1m3m3r77f"},{"name":"Sterntaler","_id":"cizfk5cof000dthc1z0v1zna3"},{"name":"CLion","_id":"cizfk5coi000hthc19ynapnjm"},{"name":"CMake","_id":"cizfk5coi000kthc1qkmygy4i"},{"name":"Kotlin","_id":"cizfk5coj000lthc1tuhq964d"},{"name":"AWS","_id":"cizfk5cok000othc1bwyi5so5"}]}}